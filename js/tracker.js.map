{"version":3,"sources":["webpack:///webpack/bootstrap 0e1db925ae040fcbeb0d","webpack:///./ts/tracker.ts","webpack:///./ts/utils/modern.ts","webpack:///./ts/utils/popups.ts","webpack:///./ts/piano/piano.ts","webpack:///./ts/tracker/song.ts","webpack:///./ts/tracker/pianola.ts"],"names":["rowWithNotes","createNotes","starWars","removeArrayElement","logarithm","linear2log","log2linear","alert","progress","close","confirm","prompt","PianoKeys","PianoKeys.constructor","PianoKeys.createKeys","PianoKeys.hasBlack","PianoKeyboard","PianoKeyboard.constructor","PianoKeyboard.registerKey","PianoKeyboard.registerButtons","PianoKeyboard.updateOctave","PianoKeyboard.displayKeyDown","PianoKeyboard.displayKeyUp","PianoKeyboard.midi2key","PianoKeyboard.setEnvelope","PianoKeyboard.togglePoly","PianoKeyboard.getPortamento","PianoKeyboard.changeArpeggioMode","PianoKeyboard.changeArpeggioOctave","PianoKeyboard.triggerArpeggioChange","PianoKeyboard.toJSON","PianoKeyboard.fromJSON","PianoKeyboard.noteOn","PianoKeyboard.noteOff","PianoKeyboard.polyOn","PianoKeyboard.polyOff","PianoKeyboard.octaveChanged","PianoKeyboard.arpeggioChanged","Note","Note.constructor","Note.on","Note.off","NoteRow","NoteRow.constructor","Part","Part.constructor","Track","Track.constructor","Song","Song.constructor","Song.play","Song.stop","NoteCanvas","NoteCanvas.constructor","NoteCanvas.paintNoteColumns","NoteCanvas.renderPastNotes","NoteCanvas.renderFutureNotes","NoteCanvas.updateNotes","NoteCanvas.renderRow"],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;;ACtCA,mCAA0B,EAAe,CAAC;AAC1C,KAAY,OAAO,uBAAM,EAAgB,CAAC;AAC1C,qCAA2B,EAAmB,CAAC;AAG/C;KAAsBA,eAAQA;UAARA,WAAQA,CAARA,sBAAQA,CAARA,IAAQA;SAARA,8BAAQA;;KAC7BA,IAAMA,EAAEA,GAAGA,IAAIA,OAAOA,CAACA,OAAOA,EAAEA,CAACA;KACjCA,EAAEA,CAACA,KAAKA,GAAGA,KAAKA,CAACA;KACjBA,MAAMA,CAACA,EAAEA,CAACA;AACXA,EAACA;AAED;KACCC,IAAMA,IAAIA,GAAGA,EAAEA,CAACA;KAChBA,IAAIA,CAACA,GAAGA,CAACA,CAACA;KACVA,IAAIA,CAACA,CAACA,CAACA,GAAGA,YAAYA,CAACA,OAAOA,CAACA,IAAIA,CAACA,EAAEA,CAACA,EAAEA,CAACA,CAACA,CAACA;KAC5CA,CAACA,IAAIA,CAACA,CAACA;KACPA,IAAIA,CAACA,CAACA,CAACA,GAAGA,YAAYA,CAACA,OAAOA,CAACA,IAAIA,CAACA,GAAGA,CAACA,EAAEA,CAACA,EAAEA,OAAOA,CAACA,IAAIA,CAACA,EAAEA,CAACA,EAAEA,CAACA,CAACA,CAACA;KAClEA,CAACA,IAAIA,CAACA,CAACA;KACPA,IAAIA,CAACA,CAACA,EAAEA,CAACA,GAAGA,YAAYA,CAACA,OAAOA,CAACA,IAAIA,CAACA,GAAGA,CAACA,EAAEA,CAACA,EAAEA,OAAOA,CAACA,IAAIA,CAACA,EAAEA,CAACA,EAAEA,CAACA,CAACA,CAACA;KACpEA,IAAIA,CAACA,CAACA,EAAEA,CAACA,GAAGA,YAAYA,CAACA,OAAOA,CAACA,IAAIA,CAACA,GAAGA,CAACA,EAAEA,CAACA,EAAEA,OAAOA,CAACA,IAAIA,CAACA,EAAEA,CAACA,EAAEA,CAACA,CAACA,CAACA;KACpEA,IAAIA,CAACA,CAACA,EAAEA,CAACA,GAAGA,YAAYA,CAACA,OAAOA,CAACA,IAAIA,CAACA,GAAGA,CAACA,EAAEA,CAACA,EAAEA,OAAOA,CAACA,IAAIA,CAACA,EAAEA,CAACA,EAAEA,CAACA,CAACA,CAACA;KACpEA,IAAIA,CAACA,CAACA,CAACA,GAAGA,YAAYA,CAACA,OAAOA,CAACA,IAAIA,CAACA,GAAGA,CAACA,EAAEA,CAACA,EAAEA,OAAOA,CAACA,IAAIA,CAACA,EAAEA,CAACA,EAAEA,CAACA,CAACA,CAACA;KAClEA,CAACA,IAAIA,CAACA,CAACA;KACPA,IAAIA,CAACA,CAACA,CAACA,GAAGA,YAAYA,CAACA,OAAOA,CAACA,IAAIA,CAACA,GAAGA,CAACA,EAAEA,CAACA,EAAEA,OAAOA,CAACA,IAAIA,CAACA,EAAEA,CAACA,EAAEA,CAACA,CAACA,CAACA;KAClEA,CAACA,IAAIA,CAACA,CAACA;KACPA,IAAIA,CAACA,CAACA,EAAEA,CAACA,GAAGA,YAAYA,CAACA,OAAOA,CAACA,IAAIA,CAACA,GAAGA,CAACA,EAAEA,CAACA,EAAEA,OAAOA,CAACA,IAAIA,CAACA,EAAEA,CAACA,EAAEA,CAACA,CAACA,CAACA;KACpEA,IAAIA,CAACA,CAACA,EAAEA,CAACA,GAAGA,YAAYA,CAACA,OAAOA,CAACA,IAAIA,CAACA,GAAGA,CAACA,EAAEA,CAACA,EAAEA,OAAOA,CAACA,IAAIA,CAACA,EAAEA,CAACA,EAAEA,CAACA,CAACA,CAACA;KACpEA,IAAIA,CAACA,CAACA,EAAEA,CAACA,GAAGA,YAAYA,CAACA,OAAOA,CAACA,IAAIA,CAACA,GAAGA,CAACA,EAAEA,CAACA,EAAEA,OAAOA,CAACA,IAAIA,CAACA,EAAEA,CAACA,EAAEA,CAACA,CAACA,CAACA;KACpEA,IAAIA,CAACA,CAACA,CAACA,GAAGA,YAAYA,CAACA,OAAOA,CAACA,IAAIA,CAACA,GAAGA,CAACA,EAAEA,CAACA,EAAEA,OAAOA,CAACA,IAAIA,CAACA,EAAEA,CAACA,EAAEA,CAACA,CAACA,CAACA;KAClEA,CAACA,IAAIA,CAACA,CAACA;KACPA,IAAIA,CAACA,CAACA,CAACA,GAAGA,YAAYA,CAACA,OAAOA,CAACA,IAAIA,CAACA,GAAGA,CAACA,EAAEA,CAACA,EAAEA,OAAOA,CAACA,IAAIA,CAACA,EAAEA,CAACA,EAAEA,CAACA,CAACA,CAACA;KAClEA,CAACA,IAAIA,CAACA,CAACA;KACPA,IAAIA,CAACA,CAACA,EAAEA,CAACA,GAAGA,YAAYA,CAACA,OAAOA,CAACA,IAAIA,CAACA,GAAGA,CAACA,EAAEA,CAACA,EAAEA,OAAOA,CAACA,IAAIA,CAACA,EAAEA,CAACA,EAAEA,CAACA,CAACA,CAACA;KACpEA,IAAIA,CAACA,CAACA,EAAEA,CAACA,GAAGA,YAAYA,CAACA,OAAOA,CAACA,IAAIA,CAACA,GAAGA,CAACA,EAAEA,CAACA,EAAEA,OAAOA,CAACA,IAAIA,CAACA,EAAEA,CAACA,EAAEA,CAACA,CAACA,CAACA;KACpEA,IAAIA,CAACA,CAACA,EAAEA,CAACA,GAAGA,YAAYA,CAACA,OAAOA,CAACA,IAAIA,CAACA,GAAGA,CAACA,EAAEA,CAACA,EAAEA,OAAOA,CAACA,IAAIA,CAACA,EAAEA,CAACA,EAAEA,CAACA,CAACA,CAACA;KACpEA,IAAIA,CAACA,CAACA,CAACA,GAAGA,YAAYA,CAACA,OAAOA,CAACA,IAAIA,CAACA,GAAGA,CAACA,EAAEA,CAACA,EAAEA,OAAOA,CAACA,IAAIA,CAACA,EAAEA,CAACA,EAAEA,CAACA,CAACA,CAACA;KAClEA,CAACA,IAAIA,CAACA,CAACA;KACPA,IAAIA,CAACA,CAACA,CAACA,GAAGA,YAAYA,CAACA,OAAOA,CAACA,IAAIA,CAACA,GAAGA,CAACA,EAAEA,CAACA,CAACA,CAACA;KAC7CA,MAAMA,CAACA,IAAIA,CAACA;AACbA,EAACA;AAED;KACCC,IAAMA,CAACA,GAAGA,IAAIA,OAAOA,CAACA,IAAIA,EAAEA,CAACA;KAC7BA,CAACA,CAACA,UAAUA,G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","file":"tracker.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 0e1db925ae040fcbeb0d\n **/","import { PianoKeys } from './piano/piano';\nimport * as tracker from './tracker/song';\nimport { NoteCanvas } from './tracker/pianola';\n\n\nfunction rowWithNotes(...notes): tracker.NoteRow {\n\tconst nr = new tracker.NoteRow();\n\tnr.notes = notes;\n\treturn nr;\n}\n\nfunction createNotes(): tracker.NoteRow[] {\n\tconst rows = [];\n\tlet i = 0;\n\trows[i] = rowWithNotes(tracker.Note.on(48));\n\ti += 4;\n\trows[i] = rowWithNotes(tracker.Note.off(48), tracker.Note.on(55));\n\ti += 4;\n\trows[i++] = rowWithNotes(tracker.Note.off(55), tracker.Note.on(53));\n\trows[i++] = rowWithNotes(tracker.Note.off(53), tracker.Note.on(52));\n\trows[i++] = rowWithNotes(tracker.Note.off(52), tracker.Note.on(50));\n\trows[i] = rowWithNotes(tracker.Note.off(50), tracker.Note.on(60));\n\ti += 4;\n\trows[i] = rowWithNotes(tracker.Note.off(60), tracker.Note.on(55));\n\ti += 4;\n\trows[i++] = rowWithNotes(tracker.Note.off(55), tracker.Note.on(53));\n\trows[i++] = rowWithNotes(tracker.Note.off(53), tracker.Note.on(52));\n\trows[i++] = rowWithNotes(tracker.Note.off(52), tracker.Note.on(50));\n\trows[i] = rowWithNotes(tracker.Note.off(50), tracker.Note.on(60));\n\ti += 4;\n\trows[i] = rowWithNotes(tracker.Note.off(60), tracker.Note.on(55));\n\ti += 4;\n\trows[i++] = rowWithNotes(tracker.Note.off(55), tracker.Note.on(53));\n\trows[i++] = rowWithNotes(tracker.Note.off(53), tracker.Note.on(52));\n\trows[i++] = rowWithNotes(tracker.Note.off(52), tracker.Note.on(53));\n\trows[i] = rowWithNotes(tracker.Note.off(53), tracker.Note.on(50));\n\ti += 4;\n\trows[i] = rowWithNotes(tracker.Note.off(50));\n\treturn rows;\n}\n\nfunction starWars(): tracker.Song {\n\tconst p = new tracker.Part();\n\tp.instrument = null; //TODO\n\tp.voices = 1;\n\tp.name = 'Main theme';\n\tp.rows = createNotes();\n\tconst t = new tracker.Track();\n\tt.parts.push(p);\n\tconst s = new tracker.Song();\n\ts.title = 'Star Wars';\n\ts.bpm = 90;\n\ts.tracks.push(t);\n\treturn s;\n}\n\n\n//--------------------------------------------------\n\nconst NUM_WHITES = 28;\n\nconst pk = new PianoKeys(NUM_WHITES);\nconst keys = pk.createKeys($('#piano'));\n\nconst past = new NoteCanvas($('#past-notes'), NUM_WHITES * 2);\npast.paintNoteColumns();\nconst future = new NoteCanvas($('#future-notes'), NUM_WHITES * 2);\nfuture.paintNoteColumns();\n\nconst sw = starWars();\nfuture.part = sw.tracks[0].parts[0];\nfuture.keys = keys;\nfuture.renderFutureNotes(0);\n\n\n/** WEBPACK FOOTER **\n ** ./ts/tracker.ts\n **/","/**\n * Modernize browser interfaces so that TypeScript does not complain\n * when using new features.\n *\n * Also provides some basic utility funcitons which should be part of\n * the standard JavaScript library.\n */\n\nexport interface ModernWindow extends Window {\n\tAudioContext: AudioContext;\n\twebkitAudioContext: AudioContext;\n}\n\nexport interface ModernAudioContext extends AudioContext {\n\tsuspend: () => void;\n\tresume: () => void;\n}\n\nexport interface ModernAudioNode extends AudioNode {\n\tdisconnect(output?: number | AudioNode | AudioParam): void\n}\n\n\nexport function removeArrayElement(a: any[], e: any): boolean {\n\tconst pos = a.indexOf(e);\n\tif (pos < 0) return false;\t// not found\n\ta.splice(pos, 1);\n\treturn true;\n}\n\nconst LOG_BASE = 2;\n\nfunction logarithm(base: number, x: number): number {\n\treturn Math.log(x) / Math.log(base);\n}\n\nexport function linear2log(value: number, min: number, max: number): number {\n\tconst logRange = logarithm(LOG_BASE, max + 1 - min);\n\treturn logarithm(LOG_BASE, value + 1 - min) / logRange;\n}\n\nexport function log2linear(value: number, min: number, max: number): number {\n\tconst logRange = logarithm(LOG_BASE, max + 1 - min);\n\treturn min + Math.pow(LOG_BASE, value * logRange) - 1;\n}\n\n\n/** WEBPACK FOOTER **\n ** ./ts/utils/modern.ts\n **/","/** Informs whether a popup is open or not */\nexport let isOpen: boolean = false;\n\n/** Bootstrap-based equivalent of standard alert function */\nexport function alert(msg: string, title?: string, hideClose?: boolean, options?: any): void {\n\tpopup.find('.popup-message').html(msg);\n\tpopup.find('.modal-title').text(title || 'Alert');\n\tpopup.find('.popup-ok').hide();\n\tif (hideClose)\n\t\tpopup.find('.popup-close').hide();\n\telse\n\t\tpopup.find('.popup-close').html('Close');\n\tpopup.find('.popup-prompt > input').hide();\n\tisOpen = true;\n\tpopup.one('hidden.bs.modal', _ => isOpen = false);\n\tpopup.modal(options);\n}\n\n/** Like an alert, but without a close button */\nexport function progress(msg: string, title?: string): void {\n\talert(msg, title, true, { keyboard: false });\n}\n\n/** Closes a popup in case it is open */\nexport function close() {\n\tif (!isOpen) return;\n\tpopup.find('.popup-ok').click();\n}\n\n/** Bootstrap-based equivalent of standard confirm function */\nexport function confirm(msg: string, title: string,\n\tcbClose: (boolean) => void, cbOpen?: () => void) {\n\tlet result = false;\n\tpopup.find('.popup-message').html(msg);\n\tpopup.find('.modal-title').text(title || 'Please confirm');\n\tconst okButton = popup.find('.popup-ok');\n\tokButton.show().click(_ => result = true);\n\tpopup.find('.popup-prompt > input').hide();\n\tpopup.find('.popup-close').text('Cancel');\n\tpopup.one('shown.bs.modal', _ => {\n\t\tokButton.focus();\n\t\tif (cbOpen) cbOpen();\n\t});\n\tpopup.find('form').one('submit', _ => {\n\t\tresult = true;\n\t\tokButton.click();\n\t\treturn false;\n\t});\n\tpopup.one('hide.bs.modal', _ => {\n\t\tokButton.off('click');\n\t\tisOpen = false;\n\t\tcbClose(result);\n\t});\n\tisOpen = true;\n\tpopup.modal();\n}\n\n/** Bootstrap-based equivalent of standard prompt function */\nexport function prompt(msg: string, title: string,\n\tinitialValue: string, cb: (string) => void): void {\n\tconst input = popup.find('.popup-prompt > input');\n\tconfirm(msg, title, confirmed => {\n\t\tif (!cb) return;\n\t\tif (!confirmed) cb(null);\n\t\telse cb(input.val());\n\t}, () => {\n\t\tinput.show();\n\t\tinput.focus();\n\t\tif (initialValue) {\n\t\t\tinput.val(initialValue);\n\t\t\tconst hinput: HTMLInputElement = <HTMLInputElement>input[0];\n\t\t\thinput.select();\n\t\t}\n\t\telse input.val('');\n\t});\n}\n\n\nconst popup = $(`\n\t<div class=\"normal-font modal fade\" id=\"myModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myModalLabel\">\n\t<div class=\"modal-dialog\" role=\"document\">\n\t\t<div class=\"modal-content\">\n\t\t<div class=\"modal-header\">\n\t\t\t<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>\n\t\t\t<h4 class=\"modal-title\" id=\"myModalLabel\"></h4>\n\t\t</div>\n\t\t<div class=\"modal-body\">\n\t\t\t<div class=\"popup-message\"></div>\n\t\t\t<form class=\"popup-prompt\">\n\t\t\t\t<input type=\"text\" style=\"width: 100%\">\n\t\t\t</form>\n\t\t</div>\n\t\t<div class=\"modal-footer\">\n\t\t\t<button type=\"button\" class=\"btn btn-default popup-close\" data-dismiss=\"modal\"></button>\n\t\t\t<button type=\"button\" class=\"btn btn-primary popup-ok\" data-dismiss=\"modal\">OK</button>\n\t\t</div>\n\t\t</div>\n\t</div>\n\t</div>\n`);\n\n$('body').append(popup);\n\n\n\n\n/** WEBPACK FOOTER **\n ** ./ts/utils/popups.ts\n **/","import * as popups from '../utils/popups';\nimport { log2linear, linear2log } from '../utils/modern';\n\nconst NUM_WHITES = 17;\nconst BASE_NOTE = 36;\n\nconst ARPEGGIO_MODES = ['', 'u', 'd', 'ud'];\nconst ARPEGGIO_LABELS = ['-', '&uarr;', '&darr;', '&uarr;&darr;'];\nconst MAX_ARPEGGIO_OCT = 3;\nconst ARPEGGIO_MIN = 15;\nconst ARPEGGIO_MAX = 480;\n\nconst PORTAMENTO_MIN = 0;\nconst PORTAMENTO_MAX = 1;\n\n\n/** Builds a piano keyboard out of DIVs */\nexport class PianoKeys {\n\tconstructor(public numWhites = NUM_WHITES) {\n\t}\n\n\tcreateKeys(panel: JQuery): JQuery[] {\n\t\tconst keys = [];\n\t\tconst pw = panel.width();\n\t\tconst ph = panel.height();\n\t\tconst fromX = parseFloat(panel.css('padding-left'));\n\t\tconst fromY = parseFloat(panel.css('padding-top'));\n\t\tconst kw = pw / this.numWhites + 1;\n\t\tconst bw = Math.round(kw * 2 / 3);\n\t\tconst bh = Math.round(ph * 2 / 3);\n\t\t// Create white keys\n\t\tlet knum = 0;\n\t\tfor (let i = 0; i < this.numWhites; i++) {\n\t\t\tconst key = $('<div class=\"piano-key\">').css({\n\t\t\t\twidth: '' + kw + 'px',\n\t\t\t\theight: '' + ph + 'px'\n\t\t\t});\n\t\t\tpanel.append(key);\n\t\t\tkeys[knum++] = key;\n\t\t\tif (this.hasBlack(i)) knum++;\n\t\t}\n\t\t// Create black keys\n\t\tknum = 0;\n\t\tlet x = fromX - bw / 2;\n\t\tfor (let i = 0; i < this.numWhites - 1; i++) {\n\t\t\tx += kw - 1;\n\t\t\tknum++;\n\t\t\tif (!this.hasBlack(i)) continue;\n\t\t\tconst key = $('<div class=\"piano-key piano-black\">').css({\n\t\t\t\twidth: '' + bw + 'px',\n\t\t\t\theight: '' + bh + 'px',\n\t\t\t\tleft: '' + x + 'px',\n\t\t\t\ttop: '' + fromY + 'px'\n\t\t\t});\n\t\t\tpanel.append(key);\n\t\t\tkeys[knum++] = key;\n\t\t}\n\t\treturn keys;\n\t}\n\n\thasBlack(num: number): boolean {\n\t\tconst mod7 = num % 7;\n\t\treturn mod7 != 2 && mod7 != 6;\n\t}\n\n}\n\n/**\n * A virtual piano keyboard that:\n * \t- Captures mouse input and generates corresponding note events\n * \t- Displays note events as CSS-animated colors in the pressed keys\n * \t- Supports octave switching\n * \t- Provides a poly/mono button\n */\nexport class PianoKeyboard {\n\tkeys: JQuery[];\n\tk1note: number;\n\tbaseNote: number;\n\toctave: number;\n\tpoly: boolean;\n\tlastKey: JQuery;\n\tenvelope: { attack: number; release: number };\n\tportaSlider: JQuery;\n\tcontrols: JQuery;\n\tarpeggio = {\n\t\tmode: 0,\n\t\toctave: 1,\n\t\tbpm: 60\n\t};\n\n\tconstructor(panel: JQuery) {\n\t\tthis.baseNote = BASE_NOTE;\n\t\tthis.octave = 3;\n\t\tthis.poly = false;\n\t\tthis.envelope = { attack: 0, release: 0 };\n\t\tconst pianoKeys = new PianoKeys();\n\t\tthis.keys = pianoKeys.createKeys(panel);\n\t\tfor (let i = 0; i < this.keys.length; i++)\n\t\t\tthis.registerKey(this.keys[i], i);\n\t\tthis.controls = panel.parent();\n\t\tthis.registerButtons(this.controls);\n\t\tthis.portaSlider = this.controls.find('.portamento-box input');\n\t}\n\n\tregisterKey(key: JQuery, knum: number): void {\n\t\tkey.mousedown(_ => {\n\t\t\tconst midi = knum + this.baseNote;\n\t\t\tthis.displayKeyDown(key);\n\t\t\tthis.noteOn(midi);\n\t\t});\n\t\tkey.mouseup(_ => {\n\t\t\tconst midi = knum + this.baseNote;\n\t\t\tthis.displayKeyUp(key);\n\t\t\tthis.noteOff(midi);\n\t\t});\n\t}\n\n\tregisterButtons(panel: JQuery): void {\n\t\t// Octave navigation\n\t\t$('#prev-octave-but').click(_ => {\n\t\t\tthis.octave--;\n\t\t\tthis.updateOctave();\n\t\t});\n\t\t$('#next-octave-but').click(_ => {\n\t\t\tthis.octave++;\n\t\t\tthis.updateOctave();\n\t\t});\n\t\t// Arpeggio\n\t\tconst arpeggioSlider = panel.find('.arpeggio-box input');\n\t\tarpeggioSlider.on('input',_ => {\n\t\t\tthis.arpeggio.bpm =\n\t\t\t\tlog2linear(parseFloat(arpeggioSlider.val()), ARPEGGIO_MIN, ARPEGGIO_MAX);\n\t\t\t\t// ARPEGGIO_MIN + parseFloat(arpeggioSlider.val()) * (ARPEGGIO_MAX - ARPEGGIO_MIN);\n\t\t\tthis.triggerArpeggioChange();\n\t\t});\n\t\tconst butArpMode = panel.find('.btn-arpeggio-ud');\n\t\tbutArpMode.click(_ => this.changeArpeggioMode(butArpMode));\n\t\tconst butArpOct = panel.find('.btn-arpeggio-oct');\n\t\tbutArpOct.click(_ => this.changeArpeggioOctave(butArpOct));\n\t\t// Monophonic / polyphonic mode\n\t\t$('#poly-but').click(_ => this.togglePoly());\n\t}\n\n\tupdateOctave() {\n\t\t$('#prev-octave-but').prop('disabled', this.octave <= 1);\n\t\t$('#next-octave-but').prop('disabled', this.octave >= 8);\n\t\t$('#octave-label').text('C' + this.octave);\n\t\tthis.baseNote = BASE_NOTE + 12 * (this.octave - 3);\n\t\tthis.octaveChanged(this.baseNote);\n\t}\n\n\tdisplayKeyDown(key): void {\n\t\tif (typeof key == 'number') key = this.midi2key(key);\n\t\tif (!key) return;\n\t\tif (!this.poly && this.arpeggio.mode == 0 && this.lastKey)\n\t\t\tthis.displayKeyUp(this.lastKey, true);\n\t\tkey.css('transition', `background-color ${this.envelope.attack}s linear`);\n\t\tkey.addClass('piano-key-pressed');\n\t\tthis.lastKey = key;\n\t}\n\n\tdisplayKeyUp(key, immediate?) {\n\t\tif (typeof key == 'number') key = this.midi2key(key);\n\t\tif (!key) return;\n\t\tconst release = immediate ? 0 : this.envelope.release;\n\t\tkey.css('transition', `background-color ${release}s linear`);\n\t\tkey.removeClass('piano-key-pressed');\n\t}\n\n\tmidi2key(midi: number) {\n\t\treturn this.keys[midi - this.baseNote];\n\t}\n\n\tsetEnvelope(adsr) {\n\t\tthis.envelope = adsr;\n\t}\n\n\ttogglePoly() {\n\t\tthis.poly = !this.poly;\n\t\tif (this.poly) {\n\t\t\tconst cover = $('<div>').addClass('editor-cover');\n\t\t\tcover.append('<p>You can use the PC keyboard to play notes<br><br>' +\n\t\t\t\t'Synth editing is disabled in polyphonic mode</p>');\n\t\t\t$('body').append(cover);\n\t\t\t$('#poly-but').text('Poly');\n\t\t\tpopups.isOpen = true;\n\t\t\tthis.polyOn();\n\t\t}\n\t\telse {\n\t\t\t$('.editor-cover').remove();\n\t\t\t$('#poly-but').text('Mono');\n\t\t\tpopups.isOpen = false;\n\t\t\tthis.polyOff();\n\t\t}\n\t}\n\n\tgetPortamento(): number {\n\t\tconst sv = parseFloat(this.portaSlider.val());;\n\t\treturn log2linear(sv, PORTAMENTO_MIN, PORTAMENTO_MAX);\n\t}\n\n\tchangeArpeggioMode(button: JQuery) {\n\t\tthis.arpeggio.mode++;\n\t\tif (this.arpeggio.mode >= ARPEGGIO_MODES.length)\n\t\t\tthis.arpeggio.mode = 0;\n\t\tbutton.html(ARPEGGIO_LABELS[this.arpeggio.mode]);\n\t\tthis.triggerArpeggioChange();\n\t}\n\n\tchangeArpeggioOctave(button: JQuery) {\n\t\tthis.arpeggio.octave++;\n\t\tif (this.arpeggio.octave > MAX_ARPEGGIO_OCT)\n\t\t\tthis.arpeggio.octave = 1;\n\t\tbutton.text(this.arpeggio.octave);\n\t\tthis.triggerArpeggioChange();\n\t}\n\n\ttriggerArpeggioChange() {\n\t\tthis.arpeggioChanged(this.arpeggio.bpm,\n\t\t\tARPEGGIO_MODES[this.arpeggio.mode], this.arpeggio.octave);\n\t}\n\n\ttoJSON(): any {\n\t\treturn {\n\t\t\tportamento: this.getPortamento(),\n\t\t\toctave: this.octave,\n\t\t\tarpeggio: {\n\t\t\t\tbpm: this.arpeggio.bpm,\n\t\t\t\tmode: this.arpeggio.mode,\n\t\t\t\toctave: this.arpeggio.octave\n\t\t\t}\n\t\t}\n\t}\n\n\tfromJSON(json): void {\n\t\tif (!json) return;\n\t\tif (json.portamento) {\n\t\t\tthis.portaSlider.val(\n\t\t\t\tlinear2log(json.portamento, PORTAMENTO_MIN, PORTAMENTO_MAX));\n\t\t}\n\t\tif (json.octave) {\n\t\t\tthis.octave = json.octave;\n\t\t\tthis.updateOctave();\n\t\t}\n\t\tif (json.arpeggio) {\n\t\t\tthis.arpeggio.bpm = json.arpeggio.bpm;\n\t\t\tthis.arpeggio.mode = json.arpeggio.mode;\n\t\t\tthis.arpeggio.octave = json.arpeggio.octave;\n\t\t\tthis.controls.find('.arpeggio-box input').val(\n\t\t\t\tlinear2log(this.arpeggio.bpm, ARPEGGIO_MIN, ARPEGGIO_MAX));\n\t\t\tthis.controls.find('.btn-arpeggio-ud').html(ARPEGGIO_LABELS[this.arpeggio.mode]);\n\t\t\tthis.controls.find('.btn-arpeggio-oct').text(this.arpeggio.octave);\n\t\t\tthis.triggerArpeggioChange();\n\t\t}\n\t}\n\n\t// Simple event handlers\n\tnoteOn(midi: number): void {}\n\tnoteOff(midi: number): void {}\n\tpolyOn() {}\n\tpolyOff() {}\n\toctaveChanged(baseNote) {}\n\tarpeggioChanged(bpm: number, mode: string, octaves: number) {}\n}\n\n\n/** WEBPACK FOOTER **\n ** ./ts/piano/piano.ts\n **/","export class Note {\r\n\tstatic NoteOn = 0;\r\n\tstatic NoteOff = 1;\r\n\ttype: number;\r\n\tmidi: number;\r\n\tvelocity: number;\r\n\tconstructor(type, midi, velocity = 1) {\r\n\t\tthis.type = type;\r\n\t\tthis.midi = midi;\r\n\t\tthis.velocity = velocity;\r\n\t}\r\n\tstatic on(midi, velocity = 1): Note {\r\n\t\treturn new Note(Note.NoteOn, midi, velocity);\r\n\t}\r\n\tstatic off(midi, velocity = 1): Note {\r\n\t\treturn new Note(Note.NoteOff, midi, velocity);\r\n\t}\r\n}\r\n\r\nexport class NoteRow {\r\n\tnotes: Note[];\r\n\tcommands: any[];\r\n}\r\n\r\nexport class Part {\r\n\tname: string;\r\n\tvoices: number;\r\n\tinstrument: any;\r\n\trows: NoteRow[] = [];\r\n}\r\n\r\nexport class Track {\r\n\tparts: Part[] = [];\r\n}\r\n\r\nexport class Song {\r\n\ttitle: string;\r\n\tbpm: number;\r\n\ttracks: Track[] = [];\r\n\tplay() {}\r\n\tstop() {}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./ts/tracker/song.ts\n **/","import * as tracker from './song';\r\n\r\nconst NOTE_COLOR = '#0CC';\r\nconst BASE_NOTE = 24;\r\n\r\nexport class NoteCanvas {\r\n\tcanvas: HTMLCanvasElement;\r\n\tgc: CanvasRenderingContext2D;\r\n\tnumKeys: number;\r\n\tnoteW: number;\r\n\tpart: tracker.Part;\r\n\tkeys: JQuery[];\r\n\tnotes: number[];\r\n\r\n\tconstructor($canvas: JQuery, numKeys: number) {\r\n\t\tthis.canvas = <HTMLCanvasElement>$canvas[0];\r\n\t\tthis.gc = this.canvas.getContext('2d');\r\n\t\tthis.numKeys = numKeys;\r\n\t\tthis.notes = [];\r\n\t}\r\n\r\n\tpaintNoteColumns() {\r\n\t\tconst w = this.canvas.width / this.numKeys;\r\n\t\tthis.noteW = w;\r\n\t\tlet x = w/2;\r\n\t\tthis.gc.translate(-2, 0);\r\n\t\tthis.gc.fillStyle = '#E0E0E0';\r\n\t\tlet oldx = 0;\r\n\t\tfor (let i = 0; i < this.numKeys - 1; i++) {\r\n\t\t\tif (i % 2)\t//  && pk.hasBlack((i-1)/2)\r\n\t\t\t\tthis.gc.fillRect(Math.round(x), 0, Math.round(x - oldx), this.canvas.height);\r\n\t\t\toldx = x;\r\n\t\t\tx += w;\r\n\t\t}\r\n\t}\r\n\r\n\trenderPastNotes(start: number) {\r\n\t}\r\n\r\n\trenderFutureNotes(start: number) {\r\n\t\tlet y = 0;\r\n\t\tfor (let i = start; i < this.part.rows.length; i++) {\r\n\t\t\tconst row = this.part.rows[i];\r\n\t\t\tthis.updateNotes(this.part.rows[i]);\r\n\t\t\tthis.renderRow(y++, row);\r\n\t\t}\r\n\t}\r\n\r\n\tupdateNotes(row: tracker.NoteRow) {\r\n\t\tconst notes = row && row.notes ? row.notes : [];\r\n\t\tlet note;\r\n\t\tfor (note of notes) {\r\n\t\t\tif (note.type == tracker.Note.NoteOn)\r\n\t\t\t\tthis.notes.push(note.midi);\r\n\t\t\telse if (note.type == tracker.Note.NoteOff)\r\n\t\t\t\tthis.notes = this.notes.filter(midi => midi != note.midi);\r\n\t\t}\r\n\t}\r\n\r\n\trenderRow(y: number, row: tracker.NoteRow) {\r\n\t\tthis.gc.fillStyle = NOTE_COLOR;\r\n\t\tconst wh = this.noteW;\r\n\t\tconst ofs = $(this.canvas).offset().left;\r\n\t\tfor (const midi of this.notes) {\r\n\t\t\tconst $key = this.keys[midi - BASE_NOTE];\r\n\t\t\tlet x = $key.offset().left - ofs;\r\n\t\t\tx -= $key.hasClass('piano-black') ? 6.5 : 3;\r\n\t\t\tthis.gc.fillRect(x, y * wh, wh, wh);\r\n\t\t}\r\n\t}\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./ts/tracker/pianola.ts\n **/"],"sourceRoot":""}