{"version":3,"sources":["webpack:///webpack/bootstrap 8ec84d8cc37995f23623","webpack:///./ts/main.ts","webpack:///./ts/graph.ts"],"names":["drag","Graph","Graph.constructor","Graph.addNode","Graph.draw","Node","Node.constructor","Node.addInput","clearCanvas","drawArrow","drawArrowTip","getNodeCenter"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 8ec84d8cc37995f23623\n **/","import { Graph, Node } from './graph';\r\n\r\nconst gr = new Graph(<HTMLCanvasElement>$('#graph-canvas')[0]);\r\n\r\nconst tmp = $('<div>').addClass('arrow');\r\n$('body').append(tmp);\r\ngr.arrowColor = tmp.css('color');\r\ntmp.remove();\r\n\r\nconst n1 = new Node(10, 10);\r\nconst n2 = new Node(30, 100);\r\nconst n3 = new Node(60, 200);\r\nn1.addInput(n2);\r\nn2.addInput(n3);\r\ngr.addNode(n1);\r\ngr.addNode(n2);\r\ngr.addNode(n3);\r\n\r\ngr.draw();\r\n\r\n$('.node').draggable({\r\n\tcontainment: 'parent',\r\n\tcursor: 'move',\r\n\tdistance: 5,\r\n\tstack: '.node',\r\n\tdrag(event, ui) {\r\n\t\tconst n = ui.helper.data('node');\r\n\t\tn.x = ui.position.left;\r\n\t\tn.y = ui.position.top;\r\n\t\tgr.draw();\r\n\t}\r\n});\n\n\n/** WEBPACK FOOTER **\n ** ./ts/main.ts\n **/","export class Graph {\r\n\r\n\tcanvas: HTMLCanvasElement;\r\n\tgc: CanvasRenderingContext2D;\r\n\tnodeCanvas: JQuery;\r\n\tnodes: Node[] = [];\r\n\tarrowColor: string = \"black\";\r\n\t\r\n\tconstructor(canvas: HTMLCanvasElement) {\r\n\t\tthis.canvas = canvas;\r\n\t\tthis.gc = canvas.getContext('2d');\r\n\t\tthis.nodeCanvas = $(canvas.parentElement);\r\n\t}\r\n\r\n\taddNode(n: Node) {\r\n\t\tn.element = $('<div>')\r\n\t\t.addClass('node')\r\n\t\t.css({ left: n.x, top: n.y })\r\n\t\t.data('node', n);\r\n\t\tthis.nodeCanvas.append(n.element);\r\n\t\tthis.nodes.push(n);\r\n\t}\r\n\r\n\tdraw() {\r\n\t\tclearCanvas(this.gc, this.canvas);\r\n\t\tthis.gc.strokeStyle = this.arrowColor;\r\n\t\tthis.gc.lineWidth = 2;\r\n\t\tfor (const ndst of this.nodes)\r\n\t\t\tfor (const nsrc of ndst.inputs)\r\n\t\t\t\tdrawArrow(this.gc, nsrc, ndst);\r\n\t}\r\n}\r\n\r\n\r\ninterface Point {\r\n\tx: number,\r\n\ty: number\r\n}\r\n\r\nexport class Node {\r\n\tx: number;\r\n\ty: number;\r\n\tinputs: Node[] = [];\r\n\telement: JQuery;\r\n\tw: number;\r\n\th: number;\r\n\r\n\tconstructor(x: number, y: number) {\r\n\t\tthis.x = x;\r\n\t\tthis.y = y;\r\n\t}\r\n\r\n\taddInput(n: Node) {\r\n\t\tthis.inputs.push(n);\r\n\t}\r\n\r\n}\r\n\r\n\r\n//------------------------- Privates -------------------------\r\n\r\nfunction clearCanvas(gc:CanvasRenderingContext2D, canvas: HTMLCanvasElement) {\r\n\tgc.clearRect(0, 0, canvas.width, canvas.height);\r\n}\r\n\r\nfunction drawArrow(gc: CanvasRenderingContext2D, srcNode: Node, dstNode: Node) {\r\n\tconst srcPoint = getNodeCenter(srcNode);\r\n\tconst dstPoint = getNodeCenter(dstNode);\r\n\tgc.beginPath();\r\n\tgc.moveTo(srcPoint.x, srcPoint.y);\r\n\tgc.lineTo(dstPoint.x, dstPoint.y);\r\n\tgc.closePath();\r\n\tgc.stroke();\r\n\tdrawArrowTip(gc, srcPoint, dstPoint);\r\n}\r\n\r\nfunction drawArrowTip(gc: CanvasRenderingContext2D, src: Point, dst: Point) {\r\n\tconst mx = (src.x + dst.x) / 2;\r\n\tconst my = (src.y + dst.y) / 2;\r\n\tconst headlen = 10;   // length of head in pixels\r\n\tvar angle = Math.atan2(dst.y - src.y, dst.x - src.x);\r\n\tgc.beginPath();\r\n\tgc.moveTo(mx, my);\r\n\tgc.lineTo(\r\n\t\tmx - headlen * Math.cos(angle - Math.PI/6),\r\n\t\tmy - headlen * Math.sin(angle - Math.PI/6)\r\n\t);\r\n\tgc.moveTo(mx, my);\r\n\tgc.lineTo(\r\n\t\tmx - headlen * Math.cos(angle + Math.PI/6),\r\n\t\tmy - headlen * Math.sin(angle + Math.PI/6)\r\n\t);\r\n\tgc.closePath();\r\n\tgc.stroke();\r\n }\r\n\r\nfunction getNodeCenter(n: Node): Point {\r\n\tn.w = n.w || n.element.outerWidth();\r\n\tn.h = n.h || n.element.outerHeight();\r\n\treturn { x: n.x + n.w / 2, y: n.y + n.h / 2 };\r\n}\r\n\n\n\n/** WEBPACK FOOTER **\n ** ./ts/graph.ts\n **/"],"sourceRoot":""}