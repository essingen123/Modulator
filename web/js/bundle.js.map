{"version":3,"sources":["webpack:///webpack/bootstrap 0076067b2da5d087341a","webpack:///./src/utils/modern.ts","webpack:///./src/utils/file.ts","webpack:///./src/synth/synth.ts","webpack:///./src/utils/popups.ts","webpack:///./src/synth/timer.ts","webpack:///./src/synth/instrument.ts","webpack:///./src/synth/notes.ts","webpack:///./src/synth/palette.ts","webpack:///./src/synth/customNodes.ts","webpack:///./src/main.ts","webpack:///./src/synthUI/synthUI.ts","webpack:///./src/synthUI/graph.ts","webpack:///./src/synthUI/paramsUI.ts","webpack:///./src/synthUI/analyzer.ts","webpack:///./src/piano/noteInputs.ts","webpack:///./src/piano/keyboard.ts","webpack:///./src/piano/midi.ts","webpack:///./src/piano/piano.ts","webpack:///./src/piano/arpeggiator.ts","webpack:///./src/synthUI/presets.ts","webpack:///./src/live-coding/editor.ts","webpack:///./src/live-coding/live-coding.ts"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 9);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 0076067b2da5d087341a","/**\n * Modernize browser interfaces so that TypeScript does not complain\n * when using new features.\n *\n * Also provides some basic utility funcitons\n */\n\nexport interface ModernWindow extends Window {\n\tAudioContext: AudioContext\n\twebkitAudioContext: AudioContext\n}\n\nexport interface ModernAudioNode extends AudioNode {\n\tdisconnect(output?: number | AudioNode | AudioParam): void\n}\n\n\nexport function removeArrayElement(a: any[], e: any): boolean {\n\tconst pos = a.indexOf(e)\n\tif (pos < 0) return false\t// not found\n\ta.splice(pos, 1)\n\treturn true\n}\n\nconst LOG_BASE = 2\n\nfunction logarithm(base: number, x: number): number {\n\treturn Math.log(x) / Math.log(base)\n}\n\nexport function linear2log(value: number, min: number, max: number): number {\n\tconst logRange = logarithm(LOG_BASE, max + 1 - min)\n\treturn logarithm(LOG_BASE, value + 1 - min) / logRange\n}\n\nexport function log2linear(value: number, min: number, max: number): number {\n\tconst logRange = logarithm(LOG_BASE, max + 1 - min)\n\treturn min + Math.pow(LOG_BASE, value * logRange) - 1\n}\n\nexport function focusable(elem: HTMLElement | null): HTMLElement {\n\twhile (elem != null && elem.tabIndex < 0 &&\n\t\telem.nodeName.toLowerCase() != 'body')\n\t\telem = elem.parentElement\n\treturn elem || document.body\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/modern.ts","// -------------------- Encoding / decoding --------------------\n\nexport function arrayBufferToBase64(buffer: number[]) {\n\tlet binary = ''\n\tlet bytes = new Uint8Array(buffer)\n\tlet len = bytes.byteLength\n\tfor (let i = 0; i < len; i++) {\n\t\tbinary += String.fromCharCode(bytes[i])\n\t}\n\treturn window.btoa(binary)\n}\n\nexport function base64ToArrayBuffer(base64: string) {\n\tlet binary_string = window.atob(base64)\n\tlet len = binary_string.length\n\tlet bytes = new Uint8Array(len)\n\tfor (let i = 0; i < len; i++) {\n\t\tbytes[i] = binary_string.charCodeAt(i)\n\t}\n\treturn bytes.buffer\n}\n\n\n// -------------------- Downloading --------------------\n\nexport function browserSupportsDownload(): boolean {\n\treturn !(<any>window).externalHost && 'download' in $('<a>')[0]\n}\n\nexport function download(fileName: string, fileData: string) {\n\tconst a = $('<a>')\n\ta.attr('download', fileName)\n\ta.attr('href',\n\t\t'data:application/octet-stream;base64,' + btoa(fileData))\n\tconst clickEvent = new MouseEvent('click',\n\t\t{ view: window, bubbles: true, cancelable: false })\n\ta[0].dispatchEvent(clickEvent)\n}\n\n\n// -------------------- Uploading --------------------\n\nexport type UploadCallback = (buf: any, file: any) => void\n\nexport function uploadText(event: JQuery.Event, cb: UploadCallback) {\n\tupload(event, cb, 'readAsText')\n}\n\nexport function uploadArrayBuffer(event: JQuery.Event, cb: UploadCallback) {\n\tupload(event, cb, 'readAsArrayBuffer')\n}\n\nfunction upload(event: JQuery.Event, cb: UploadCallback, readFunc: string) {\n\tlet files = (<any>event.target).files\n\tif (!files || files.length <= 0) return cb('', '')\n\tconst file = files[0]\n\tconst reader = new FileReader()\n\treader.onload = (loadEvt: any)  => cb(loadEvt.target.result, file);\n\t(<any>reader)[readFunc](file)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/file.ts","import { NoteHandler, NoteHandlers } from './notes'\nimport { NodeDef, NodeParamDef, NodePalette, palette } from './palette'\nimport { ModernAudioNode, removeArrayElement } from '../utils/modern'\nimport * as custom from './customNodes'\nimport * as file from '../utils/file'\n\n\nconst SEMITONE = Math.pow(2, 1 / 12)\nconst A4 = 57\n\n/**\n * Holds all data associated with an AudioNode\n */\nexport class NodeData {\n\t// Used by all nodes\n\ttype: string\n\tanode: ModernAudioNode\n\tnodeDef: NodeDef\n\t// Used by control nodes\n\tcontrolParam: string\n\tcontrolParams: string[] | null\n\tcontrolTarget: ModernAudioNode\n\t// Used by source audio nodes\n\tnoteHandler: NoteHandler\n\t// Flag to avoid deleting output node\n\tisOut = false\n\t// Reference to owner synth\n\tsynth: Synth\n\t// To be implemented by user code\n\tgetInputs(): NodeData[] {\n\t\tthrow 'Error: getInputs() function should be implemented by user'\n\t}\n}\n\n/**\n * Global paramters that apply to the whole monophonic synthesizer.\n */\nexport class Portamento {\n\ttime = 0\n\tratio = 0\n}\n\n// TODO *** refactor & decouple from UI\nexport interface ParamHandler {\n\tuiRender: string\n\tinitialize(anode: AudioNode, def: NodeDef): void\n\tparam2json(anode: AudioNode): any\n\tjson2param(anode: AudioNode, json: any): any\n}\n\n/**\n * Performs global operations on all AudioNodes:\n * - Manages AudioNode creation, initialization and connection\n * - Distributes MIDI keyboard events to NoteHandlers\n */\nexport class Synth {\n\tac: AudioContext\n\tcustomNodes: { [key: string]: Function } = {}\n\tparamHandlers: { [key: string]: ParamHandler } = {}\n\tpalette: NodePalette\n\tnoteHandlers: NoteHandler[] = []\n\tportamento = new Portamento()\n\n\tconstructor(ac: AudioContext) {\n\t\tthis.ac = ac\n\t\tthis.palette = palette\n\t\tthis.registerCustomNode('createADSR', custom.ADSR)\n\t\tthis.registerCustomNode('createNoise', custom.NoiseGenerator)\n\t\tthis.registerCustomNode('createNoiseCtrl', custom.NoiseCtrlGenerator)\n\t\tthis.registerCustomNode('createLineIn', custom.LineInNode)\n\t\tthis.registerCustomNode('createDetuner', custom.Detuner)\n\t\tthis.registerParamHandler('BufferDataHandler', new BufferDataHandler())\n\t\tthis.registerParamHandler('SoundBankHandler', new SoundBankHandler())\n\t}\n\n\tcreateAudioNode(type: string): AudioNode | null {\n\t\tconst def: NodeDef = palette[type]\n\t\tif (!def) return null\n\t\tconst factory: any = def.custom ? this.customNodes : this.ac\n\t\tif (!def.constructor || !factory[def.constructor]) return null\n\t\tconst anode = factory[def.constructor]()\n\t\tif (!anode.context) anode.context = this.ac\n\t\tthis.initNodeParams(anode, def, type)\n\t\treturn anode\n\t}\n\n\tinitNodeData(ndata: NodeData, type: string): void {\n\t\tndata.synth = this\n\t\tndata.type = type\n\t\tlet anode = this.createAudioNode(type)\n\t\tif (!anode)\n\t\t\treturn console.error(`No AudioNode found for '${type}'`)\n\t\tndata.anode = anode\n\t\tndata.nodeDef = this.palette[type]\n\t\tconst nh = ndata.nodeDef.noteHandler\n\t\tif (nh) {\n\t\t\tndata.noteHandler = new (<any>NoteHandlers)[nh](ndata)\n\t\t\tthis.addNoteHandler(ndata.noteHandler)\n\t\t}\n\t}\n\n\tinitOutputNodeData(ndata: NodeData, dst: AudioNode): void {\n\t\tndata.synth = this\n\t\tndata.type = 'out'\n\t\tndata.anode = this.ac.createGain()\n\t\tndata.anode.connect(dst)\n\t\tndata.nodeDef = this.palette['Speaker']\n\t\tndata.isOut = true\n\t}\n\n\tremoveNodeData(data: NodeData) {\n\t\tif (data.noteHandler)\n\t\t\tthis.removeNoteHandler(data.noteHandler)\n\t}\n\n\tconnectNodes(srcData: NodeData, dstData: NodeData): void {\n\t\tif (srcData.nodeDef.control && !dstData.nodeDef.control) {\n\t\t\tlet anode: any = dstData.anode\n\t\t\tsrcData.controlParams = Object.keys(dstData.nodeDef.params)\n\t\t\t\t.filter(pname => anode[pname] instanceof AudioParam)\n\t\t\tsrcData.controlParam = srcData.controlParams[0]\n\t\t\tsrcData.controlTarget = dstData.anode\n\t\t\tsrcData.anode.connect(anode[srcData.controlParam])\n\t\t}\n\t\telse srcData.anode.connect(dstData.anode)\n\t}\n\n\tdisconnectNodes(srcData: NodeData, dstData: NodeData): void {\n\t\tif (srcData.nodeDef.control && !dstData.nodeDef.control) {\n\t\t\tsrcData.controlParams = null\n\t\t\tsrcData.anode.disconnect((<any>dstData.anode)[srcData.controlParam])\n\t\t}\n\t\telse\n\t\t\tsrcData.anode.disconnect(dstData.anode)\n\t}\n\n\tjson2NodeData(json: any, data: NodeData): void {\n\t\tlet anydata: any = data\n\t\tfor (const pname of Object.keys(json.params)) {\n\t\t\tconst pvalue = anydata.anode[pname]\n\t\t\tconst jv = json.params[pname]\n\t\t\tif (anydata.nodeDef.params[pname].handler)\n\t\t\t\tthis.paramHandlers[anydata.nodeDef.params[pname].handler]\n\t\t\t\t\t.json2param(anydata.anode, jv)\n\t\t\telse if (pvalue instanceof AudioParam) {\n\t\t\t\tpvalue.value = jv;\n\t\t\t\t(<any>pvalue)['_value'] = jv\n\t\t\t}\n\t\t\telse anydata.anode[pname] = jv\n\t\t}\n\t}\n\n\tnodeData2json(data: any): any {\n\t\tconst params: any = {}\n\t\tfor (const pname of Object.keys(data.nodeDef.params)) {\n\t\t\tconst pvalue = data.anode[pname]\n\t\t\tif (data.nodeDef.params[pname].handler)\n\t\t\t\tparams[pname] = this.paramHandlers[data.nodeDef.params[pname].handler]\n\t\t\t\t\t.param2json(data.anode)\n\t\t\telse if (pvalue instanceof AudioParam)\n\t\t\t\tif ((<any>pvalue)['_value'] === undefined) params[pname] = pvalue.value\n\t\t\t\telse params[pname] = (<any>pvalue)['_value']\n\t\t\telse params[pname] = pvalue\n\t\t}\n\t\treturn {\n\t\t\ttype: data.type,\n\t\t\tparams,\n\t\t\tcontrolParam: data.controlParam,\n\t\t\tcontrolParams: data.controlParams\n\t\t}\n\t}\n\n\tmidi2freqRatio(midi: number): number {\n\t\treturn Math.pow(SEMITONE, midi - A4)\n\t}\n\n\tnoteOn(midi: number, gain: number, when?: number): void {\n\t\tif (!when) when = this.ac.currentTime\n\t\tconst ratio = this.midi2freqRatio(midi)\n\t\tthis.setupNoteHandlers()\n\t\tfor (const nh of this.noteHandlers)\n\t\t\tnh.noteOn(midi, gain, ratio, when)\n\t\tthis.portamento.ratio = ratio\n\t}\n\n\tnoteOff(midi: number, gain: number, when?: number): void {\n\t\tif (!when) when = this.ac.currentTime\n\t\tfor (const nh of this.noteHandlers)\n\t\t\tnh.noteOff(midi, gain, when)\n\t}\n\n\taddNoteHandler(nh: NoteHandler): void {\n\t\tthis.noteHandlers.push(nh)\n\t}\n\n\tremoveNoteHandler(nh: NoteHandler): void {\n\t\tremoveArrayElement(this.noteHandlers, nh)\n\t}\n\n\tsetupNoteHandlers() {\n\t\tlet maxRelease = 0\n\t\tfor (const nh of this.noteHandlers) {\n\t\t\tif (nh.kbTrigger && nh.releaseTime > maxRelease)\n\t\t\t\tmaxRelease = nh.releaseTime\n\t\t}\n\t\tfor (const nh of this.noteHandlers) {\n\t\t\tif (!nh.kbTrigger)\n\t\t\t\tnh.releaseTime = maxRelease\n\t\t}\n\t}\n\n\tinitNodeParams(anode: AudioNode, def: NodeDef, type: string): void {\n\t\tlet anynode: any = anode\n\t\tfor (const param of Object.keys(def.params || {}))\n\t\t\tif (anynode[param] === undefined)\n\t\t\t\tconsole.warn(`Parameter '${param}' not found for node '${type}'`)\n\t\t\telse if (anynode[param] instanceof AudioParam)\n\t\t\t\tanynode[param].value = def.params[param].initial\n\t\t\telse if (def.params[param].handler) {\n\t\t\t\tdef.params[param].phandler = this.paramHandlers[def.params[param].handler || '']\n\t\t\t\tdef.params[param].phandler.initialize(anynode, def)\n\t\t\t}\n\t\t\telse\n\t\t\t\tanynode[param] = def.params[param].initial\n\t}\n\n\tregisterCustomNode(constructorName: string, nodeClass: any): void {\n\t\tthis.customNodes[constructorName] = () => new nodeClass(this.ac)\n\t}\n\n\tregisterParamHandler(hname: string, handler: ParamHandler): void {\n\t\tthis.paramHandlers[hname] = handler\n\t}\n\n}\n\n\n\n// -------------------- Parameter handlers --------------------\n\ninterface BufferAudioNode extends AudioNode {\n\t_encoded: any\n\t_buffer: AudioBuffer\n\t_buffers: AudioBuffer[]\n\t_encodedBuffers: any[]\n\t_names: string[]\n}\n\nclass BufferDataHandler implements ParamHandler {\n\tuiRender = 'renderBufferData'\n\tinitialize(anode: AudioNode, def: NodeDef): void {}\n\n\tparam2json(anode: BufferAudioNode): any {\n\t\treturn file.arrayBufferToBase64(anode._encoded)\n\t}\n\n\tjson2param(anode: BufferAudioNode, json: any) {\n\t\tconst encoded = file.base64ToArrayBuffer(json)\n\t\tanode._encoded = encoded\n\t\tanode.context.decodeAudioData(encoded, buffer => anode._buffer = buffer)\n\t}\n}\n\nclass SoundBankHandler implements ParamHandler {\n\tuiRender = 'renderSoundBank'\n\tinitialize(anode: BufferAudioNode, def: NodeDef): void {\n\t\tanode._buffers = []\n\t\tanode._encodedBuffers = []\n\t\tanode._names = []\n\t}\n\n\tparam2json(anode: BufferAudioNode): any {\n\t\tconst files = []\n\t\tconst encs = anode._encodedBuffers\n\t\tconst names = anode._names\n\t\tfor (let i = 0; i < names.length; i++)\n\t\t\tfiles.push({\n\t\t\t\tname: names[i],\n\t\t\t\tdata: file.arrayBufferToBase64(encs[i])\n\t\t\t})\n\t\treturn files\n\t}\n\n\tjson2param(anode: BufferAudioNode, json: any) {\n\t\tconst bufs = anode._buffers\n\t\tbufs.length = 0\n\t\tconst encs = anode._encodedBuffers\n\t\tencs.length = 0\n\t\tconst names = anode._names\n\t\tnames.length = 0\n\t\tfor (let i = 0; i < json.length; i++) {\n\t\t\tconst item = json[i]\n\t\t\tnames.push(item.name)\n\t\t\tconst encoded = file.base64ToArrayBuffer(item.data)\n\t\t\tencs.push(encoded)\n\t\t\tthis.decodeBuffer(anode, encoded, bufs, i)\n\t\t}\n\t}\n\n\tdecodeBuffer(anode: AudioNode, data: ArrayBuffer,\n\t\tbufs: any[], i: number) {\n\t\tanode.context.decodeAudioData(data, buffer => bufs[i] = buffer)\n\t}\n\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/synth/synth.ts","interface JQueryWithModal extends JQuery {\n\tmodal(options?: any): void\n}\n\n/** Informs whether a popup is open or not */\nexport let isOpen = false\nexport function setOpen(open: boolean) {\n\tisOpen = open\n}\n\n/** Bootstrap-based equivalent of standard alert function */\nexport function alert(msg: string, title?: string, hideClose?: boolean, options?: any): void {\n\tpopup.find('.popup-message').html(msg)\n\tpopup.find('.modal-title').text(title || 'Alert')\n\tpopup.find('.popup-ok').hide()\n\tif (hideClose)\n\t\tpopup.find('.popup-close').hide()\n\telse\n\t\tpopup.find('.popup-close').html('Close')\n\tpopup.find('.popup-prompt > input').hide()\n\tisOpen = true\n\tpopup.one('hidden.bs.modal', _ => isOpen = false)\n\tpopup.modal(options)\n}\n\n/** Like an alert, but without a close button */\nexport function progress(msg: string, title?: string): void {\n\talert(msg, title, true, { keyboard: false })\n}\n\n/** Closes a popup in case it is open */\nexport function close() {\n\tif (!isOpen) return\n\tpopup.find('.popup-ok').click()\n}\n\n/** Bootstrap-based equivalent of standard confirm function */\nexport function confirm(msg: string, title: string,\n\tcbClose: (b: boolean) => void, cbOpen?: () => void) {\n\tlet result = false\n\tpopup.find('.popup-message').html(msg)\n\tpopup.find('.modal-title').text(title || 'Please confirm')\n\tconst okButton = popup.find('.popup-ok')\n\tokButton.show().click(_ => result = true)\n\tpopup.find('.popup-prompt > input').hide()\n\tpopup.find('.popup-close').text('Cancel')\n\tpopup.one('shown.bs.modal', _ => {\n\t\tokButton.focus()\n\t\tif (cbOpen) cbOpen()\n\t})\n\tpopup.find('form').one('submit', _ => {\n\t\tresult = true\n\t\tokButton.click()\n\t\treturn false\n\t})\n\tpopup.one('hide.bs.modal', _ => {\n\t\tokButton.off('click')\n\t\tisOpen = false\n\t\tcbClose(result)\n\t})\n\tisOpen = true\n\tpopup.modal()\n}\n\n/** Bootstrap-based equivalent of standard prompt function */\nexport function prompt(msg: string, title: string,\n\tinitialValue: string, cb: ((s: any) => void) | null): void {\n\tconst input = popup.find('.popup-prompt > input')\n\tconfirm(msg, title, confirmed => {\n\t\tif (!cb) return\n\t\tif (!confirmed) cb(null)\n\t\telse cb(input.val())\n\t}, () => {\n\t\tinput.show()\n\t\tinput.focus()\n\t\tif (initialValue) {\n\t\t\tinput.val(initialValue)\n\t\t\tconst hinput: HTMLInputElement = <HTMLInputElement>input[0]\n\t\t\thinput.select()\n\t\t}\n\t\telse input.val('')\n\t})\n}\n\n\nconst popup = <JQueryWithModal> $(`\n\t<div class=\"normal-font modal fade\" id=\"myModal\" tabindex=\"-1\" role=\"dialog\" aria-labelledby=\"myModalLabel\">\n\t<div class=\"modal-dialog\" role=\"document\">\n\t\t<div class=\"modal-content\">\n\t\t<div class=\"modal-header\">\n\t\t\t<button type=\"button\" class=\"close\" data-dismiss=\"modal\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>\n\t\t\t<h4 class=\"modal-title\" id=\"myModalLabel\"></h4>\n\t\t</div>\n\t\t<div class=\"modal-body\">\n\t\t\t<div class=\"popup-message\"></div>\n\t\t\t<form class=\"popup-prompt\">\n\t\t\t\t<input type=\"text\" style=\"width: 100%\">\n\t\t\t</form>\n\t\t</div>\n\t\t<div class=\"modal-footer\">\n\t\t\t<button type=\"button\" class=\"btn btn-default popup-close\" data-dismiss=\"modal\"></button>\n\t\t\t<button type=\"button\" class=\"btn btn-primary popup-ok\" data-dismiss=\"modal\">OK</button>\n\t\t</div>\n\t\t</div>\n\t</div>\n\t</div>\n`)\n\n$('body').append(popup)\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils/popups.ts","export interface TimerCallback {\n\t(time: number): void\n}\n\nexport class Timer {\n\trunning: boolean\n\tac: AudioContext\n\tcb: TimerCallback\n\t_bpm: number\n\tahead: number\n\tnextNoteTime: number\n\tnoteDuration: number\n\n\tconstructor(ac: AudioContext, bpm = 60, ahead = 0.1) {\n\t\tthis.running = false\n\t\tthis.ac = ac\n\t\tthis.noteDuration = 0\n\t\tthis.nextNoteTime = 0\n\t\tthis.bpm = bpm\n\t\tthis.ahead = ahead\n\t}\n\n\tget bpm() { return this._bpm }\n\n\tset bpm(v) {\n\t\tthis._bpm = v\n\t\tthis.nextNoteTime -= this.noteDuration\n\t\tthis.noteDuration = (1 / 4) * 60 / this._bpm\n\t\tthis.nextNoteTime += this.noteDuration\n\t}\n\n\tstart(cb?: TimerCallback): void {\n\t\tif (this.running) return\n\t\tthis.running = true\n\t\tif (cb) this.cb = cb\n\t\tthis.nextNoteTime = this.ac.currentTime\n\t\tthis.tick()\n\t}\n\n\tstop(): void {\n\t\tthis.running = false\n\t}\n\n\ttick(): void {\n\t\tif (!this.running) return\n\t\trequestAnimationFrame(this.tick.bind(this))\n\t\twhile (this.nextNoteTime < this.ac.currentTime + this.ahead) {\n\t\t\tif (this.cb) this.cb(this.nextNoteTime)\n\t\t\tthis.nextNoteTime += this.noteDuration\n\t\t}\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/synth/timer.ts","import { Synth, NodeData, Portamento } from './synth'\n\n\n/**\n * A polyphonic synth controlling an array of voices\n */\nexport class Instrument {\n\tvoices: Voice[]\n\tpressed: number[]\n\treleased: number[]\n\tportamento: Portamento\n\n\tconstructor(ac: AudioContext, json: any, numVoices: number, dest?: AudioNode) {\n\t\t// Setup voices\n\t\tthis.pressed = []\n\t\tthis.released = []\n\t\tthis.voices = []\n\t\tfor (let i = 0; i < numVoices; i++) {\n\t\t\tthis.voices.push(new Voice(ac, json, dest))\n\t\t\tthis.released.push(i)\n\t\t}\n\t\t// Setup synth params by having a common instance for all voices\n\t\tthis.portamento = this.voices[0].synth.portamento\n\t\tif (json.keyboard && json.keyboard.portamento)\n\t\t\tthis.portamento.time = json.keyboard.portamento\n\t\tfor (let i = 1; i < numVoices; i++)\n\t\t\tthis.voices[i].synth.portamento = this.portamento\n\t}\n\n\tnoteOn(midi: number, velocity = 1, when?: number): void {\n\t\tconst vnum = this.findVoice()\n\t\tconst voice = this.voices[vnum]\n\t\tthis.pressed.push(vnum)\n\t\tvoice.noteOn(midi, velocity, when)\n\t}\n\n\tnoteOff(midi: number, velocity = 1, when?: number): void {\n\t\tfor (let i = 0; i < this.voices.length; i++) {\n\t\t\tconst voice = this.voices[i]\n\t\t\tif (voice.lastNote == midi) {\n\t\t\t\tvoice.noteOff(midi, velocity, when)\n\t\t\t\tthis.released.push(i)\n\t\t\t\tbreak\n\t\t\t}\n\t\t}\n\t}\n\n\tallNotesOff() {\n\t\tfor (const voice of this.voices) {\n\t\t\tif (voice.lastNote) voice.noteOff(voice.lastNote)\n\t\t}\n\t}\n\n\tfindVoice(): number {\n\t\tlet voices: number[]\n\t\tif (this.released.length > 0) voices = this.released\n\t\telse if (this.pressed.length > 0) voices = this.pressed\n\t\telse throw 'This should never happen'\n\t\treturn voices.splice(0, 1)[0]\n\t}\n\n\tclose() {\n\t\tfor (const voice of this.voices) voice.close()\n\t}\n}\n\n\n/**\n * An independent monophonic synth\n */\nexport class Voice {\n\tsynth: Synth\n\tlastNote: number\n\tloader: SynthLoader\n\n\tconstructor(ac: AudioContext, json: any, dest?: AudioNode) {\n\t\tthis.loader = new SynthLoader()\n\t\tthis.synth = this.loader.load(ac, json, dest || ac.destination)\n\t\tthis.lastNote = 0\n\t}\n\n\tnoteOn(midi: number, velocity = 1, when?: number): void {\n\t\tthis.synth.noteOn(midi, velocity, when)\n\t\tthis.lastNote = midi\n\t}\n\n\tnoteOff(midi: number, velocity = 1, when?: number): void {\n\t\tthis.synth.noteOff(midi, velocity, when)\n\t\tthis.lastNote = 0\n\t}\n\n\tclose(): void {\n\t\t// This method must be called to avoid memory leaks at the Web Audio level\n\t\tif (this.lastNote) this.noteOff(this.lastNote, 1)\n\t\tthis.loader.close()\n\t}\n}\n\n\n// -------------------- Private --------------------\n\nexport class VoiceNodeData extends NodeData {\n\tinputs: NodeData[] = []\n\tconstructor(public id: number) {\n\t\tsuper()\n\t}\n\tgetInputs(): NodeData[] {\n\t\treturn this.inputs\n\t}\n}\n\nexport class SynthLoader {\n\tnodes: VoiceNodeData[] = []\n\tsynth: Synth\n\n\tload(ac: AudioContext, json: any, dest: AudioNode): Synth {\n\t\tconst synth = new Synth(ac)\n\t\t// Add nodes into id-based table\n\t\tlet j = 0\n\t\tfor (const jn of json.nodes)\n\t\t\tthis.nodes[j++] = new VoiceNodeData(jn.id)\n\t\t// Then set their list of inputs\n\t\tfor (let i = 0; i < json.nodes.length; i++)\n\t\t\tfor (const inum of json.nodes[i].inputs) {\n\t\t\t\tlet input = this.nodeById(inum)\n\t\t\t\tif (input) this.nodes[i].inputs.push(input)\n\t\t\t}\n\t\t// Then set their data\n\t\tfor (let i = 0; i < json.nodes.length; i++) {\n\t\t\tconst type = json.nodeData[i].type\n\t\t\tif (type == 'out')\n\t\t\t\tsynth.initOutputNodeData(this.nodes[i], dest)\n\t\t\telse\n\t\t\t\tsynth.initNodeData(this.nodes[i], type)\n\t\t\tsynth.json2NodeData(json.nodeData[i], this.nodes[i])\n\t\t}\n\t\t// Then notify connections to handler\n\t\tfor (const dst of this.nodes)\n\t\t\tfor (const src of dst.inputs)\n\t\t\t\tsynth.connectNodes(src, dst)\n\t\t// Finally, return the newly created synth\n\t\tthis.synth = synth\n\t\treturn synth\n\t}\n\n\tnodeById(id: number): VoiceNodeData | null {\n\t\tfor (const node of this.nodes)\n\t\t\tif (node.id === id) return node\n\t\treturn null\n\t}\n\n\tclose() {\n\t\tfor (const node of this.nodes)\n\t\t\tfor (const input of node.inputs)\n\t\t\t\tthis.synth.disconnectNodes(input, node)\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/synth/instrument.ts","import { NodeData } from './synth'\nimport { ADSR } from './customNodes'\nimport { ModernAudioNode, removeArrayElement } from '../utils/modern'\n\n\n/**\n * A note handler handles MIDI keyboard events on behalf of a synth node,\n * updating the node status accordingly.\n */\nexport interface NoteHandler {\n\tkbTrigger: boolean\n\treleaseTime: number\n\tnoteOn(midi: number, gain: number, ratio: number, when: number): void\n\tnoteOff(midi: number, gain: number, when: number): void\n}\n\n/**\n * Handles common AudioNode cloning, used by oscillator and buffered data nodes.\n */\nexport class BaseNoteHandler implements NoteHandler {\n\tndata: NodeData\n\toutTracker: OutputTracker\n\tkbTrigger = false\n\treleaseTime = 0\n\n\tconstructor(ndata: NodeData) {\n\t\tthis.ndata = ndata\n\t\tthis.outTracker = new OutputTracker(ndata.anode)\n\t}\n\n\tnoteOn(midi: number, gain: number, ratio: number, when: number): void {}\n\tnoteOff(midi: number, gain: number, when: number): void {}\n\n\tclone(): AudioNode | null {\n\t\t// Create clone\n\t\tlet ctor = this.ndata.nodeDef.constructor\n\t\tif (!ctor) return null\n\t\tconst anode = (<any>this.ndata.anode.context)[ctor]()\n\t\t// Copy parameters\n\t\tfor (const pname of Object.keys(this.ndata.nodeDef.params)) {\n\t\t\tconst param = (<any>this.ndata.anode)[pname]\n\t\t\tif (param instanceof AudioParam)\n\t\t\t\tanode[pname].value = param.value\n\t\t\telse if (param !== null && param !== undefined)\n\t\t\t\tanode[pname] = param\n\t\t}\n\t\t// Copy output connections\n\t\tfor (const out of this.outTracker.outputs) {\n\t\t\tlet o2: any = out\n\t\t\tif (o2.custom && o2.anode) o2 = o2.anode\n\t\t\tanode.connect(o2)\n\t\t}\n\t\t// Copy control input connections\n\t\tfor (const inData of this.ndata.getInputs()) {\n\t\t\tinData.anode.connect(anode[inData.controlParam])\n\t\t}\n\t\t// TODO should copy snapshot of list of inputs and outputs\n\t\t// ...in case user connects or disconnects during playback\n\t\treturn anode\n\t}\n\n\tdisconnect(anode: ModernAudioNode): void {\n\t\t// Disconnect outputs\n\t\tfor (const out of this.outTracker.outputs)\n\t\t\tanode.disconnect(out)\n\t\t// Disconnect control inputs\n\t\tfor (const inData of this.ndata.getInputs()) {\n\t\t\tinData.anode.disconnect((<any>anode)[inData.controlParam])\n\t\t}\n\t}\n\n\trampParam(param: MAudioParam, ratio: number, when: number): void {\n\t\tconst portamento = this.ndata.synth.portamento\n\t\tconst newv = param.value * ratio\n\t\tparam._value = newv\t// Required for ADSR to capture the correct value\n\t\tif (portamento.time > 0 && portamento.ratio > 0) {\n\t\t\tconst oldv = param.value * portamento.ratio\n\t\t\tparam.cancelScheduledValues(when)\n\t\t\tparam.linearRampToValueAtTime(oldv, when)\n\t\t\tparam.exponentialRampToValueAtTime(newv, when + portamento.time)\n\t\t}\n\t\telse param.setValueAtTime(newv, when)\n\t}\n}\n\n/**\n * Handles note events for an OscillatorNode\n */\nexport class OscNoteHandler extends BaseNoteHandler {\n\toscClone: OscillatorNode\n\tlastNote: number\n\n\tnoteOn(midi: number, gain: number, ratio: number, when: number): void {\n\t\tif (this.oscClone) this.oscClone.stop(when)\n\t\tthis.oscClone = <OscillatorNode>this.clone()\n\t\tthis.rampParam(<MAudioParam>this.oscClone.frequency, ratio, when)\n\t\tthis.oscClone.start(when)\n\t\tthis.lastNote = midi\n\t}\n\n\tnoteOff(midi: number, gain: number, when: number): void {\n\t\tif (midi != this.lastNote) return\t// Avoid multple keys artifacts in mono mode\n\t\tthis.oscClone.stop(when + this.releaseTime)\n\t}\n}\n\n/**\n * Handles note events for an LFO node. This is identical to a regular\n * oscillator node, but the note does not affect the oscillator frequency\n */\nexport class LFONoteHandler extends OscNoteHandler {\n\trampParam(param: AudioParam, ratio: number, when: number) {\n\t\t// Disable portamento for LFO\n\t\tparam.setValueAtTime(param.value, when)\n\t}\n}\n\n/**\n * Handles note events for an AudioBufferSourceNode\n */\nexport class BufferNoteHandler extends BaseNoteHandler {\n\tabsn: AudioBufferSourceNode\n\tlastNote: number\n\n\tnoteOn(midi: number, gain: number, ratio: number, when: number): void {\n\t\tif (this.absn)\n\t\t\tthis.absn.stop(when)\n\t\tconst buf = (<any>this.ndata.anode)._buffer\n\t\tif (!buf) return\t// Buffer still loading or failed\n\t\tthis.absn = <AudioBufferSourceNode>this.clone()\n\t\tthis.absn.buffer = buf\n\t\tconst pbr = this.absn.playbackRate\n\t\tconst newRate = pbr.value * ratio\n\t\tthis.rampParam(<MAudioParam>pbr, pbr.value * ratio, when)\n\t\tthis.absn.start(when)\n\t\tthis.lastNote = midi\n\t}\n\n\tnoteOff(midi: number, gain: number, when: number): void {\n\t\tif (midi != this.lastNote) return\n\t\tthis.absn.stop(when + this.releaseTime)\n\t}\n}\n\n/**\n * Performs computations about ramps so they can be easily rescheduled\n */\nexport class Ramp {\n\tconstructor(public v1: number, public v2: number, public t1: number, public t2: number) {}\n\tinside(t: number) {\n\t\treturn this.t1 < this.t2 && this.t1 <= t && t <= this.t2\n\t}\n\tcut(t: number) {\n\t\tconst newv = this.v1 + (this.v2 - this.v1) * (t - this.t1) / (this.t2 - this.t1)\n\t\treturn new Ramp(this.v1, newv, this.t1, t)\n\t}\n\trun(p: AudioParam, follow = false) {\n\t\tif (this.t2 - this.t1 <= 0) {\n\t\t\tp.setValueAtTime(this.v2, this.t2)\n\t\t}\n\t\telse {\n\t\t\tif (!follow) p.setValueAtTime(this.v1, this.t1)\n\t\t\tp.linearRampToValueAtTime(this.v2, this.t2)\n\t\t}\n\t}\n}\n\nexport interface MAudioParam extends AudioParam {\n\t_attack: Ramp\n\t_decay: Ramp\n\t_release: Ramp\n\t_value: number\n}\n/**\n * Handles note events for a custom ADSR node\n */\nexport class ADSRNoteHandler extends BaseNoteHandler {\n\tlastNote: number\n\tkbTrigger = true\n\n\tconstructor(ndata: NodeData) {\n\t\tsuper(ndata)\n\t\tconst adsr = this.getADSR()\n\t\tconst oldMethod = adsr.disconnect\n\t\tadsr.disconnect = (dest: AudioParam) => {\n\t\t\tthis.loopParams(param => {\n\t\t\t\tif (param == dest)\n\t\t\t\t\tparam.setValueAtTime(param._value, adsr.context.currentTime)\n\t\t\t})\n\t\t\toldMethod(dest)\n\t\t}\n\t}\n\n\tgetADSR(): ADSR {\n\t\tlet anode: any = this.ndata.anode\n\t\treturn anode\n\t}\n\n\tget releaseTime() {\n\t\tconst adsr = this.getADSR()\n\t\treturn adsr.release\n\t}\n\tset releaseTime(relTime: number) {}\n\n\tnoteOn(midi: number, gain: number, ratio: number, when: number): void {\n\t\tthis.lastNote = midi\n\t\tconst adsr = this.getADSR()\n\t\tthis.loopParams(param => {\n\t\t\tconst v = this.getParamValue(param)\n\t\t\tconst initial = (1 - adsr.depth) * v\n\t\t\tconst sustain = v * adsr.sustain + initial * (1 - adsr.sustain)\n\t\t\tconst now = adsr.context.currentTime\n\t\t\tparam.cancelScheduledValues(now)\n\t\t\tif (when > now)\n\t\t\t\tthis.rescheduleRamp(param, param._release, now)\n\t\t\tparam._attack = new Ramp(initial, v, when, when + adsr.attack)\n\t\t\tparam._decay = new Ramp(v, sustain, when + adsr.attack, when + adsr.attack + adsr.decay)\n\t\t\tparam._attack.run(param)\n\t\t\tparam._decay.run(param, true)\n\t\t})\n\t}\n\n\tnoteOff(midi: number, gain: number, when: number): void {\n\t\tif (midi != this.lastNote) return\t// Avoid multple keys artifacts in mono mode\n\t\tconst adsr = this.getADSR()\n\t\tthis.loopParams(param => {\n\t\t\tlet v = this.getRampValueAtTime(param, when)\n\t\t\tif (v === null)\n\t\t\t\tv = this.getParamValue(param) * adsr.sustain\n\t\t\tconst finalv = (1 - adsr.depth) * v\n\t\t\tparam.cancelScheduledValues(when)\n\t\t\tconst now = adsr.context.currentTime\n\t\t\tif (when > now)\n\t\t\t\t// tslint:disable-next-line:no-unused-expression\n\t\t\t\tthis.rescheduleRamp(param, param._attack, now) ||\n\t\t\t\tthis.rescheduleRamp(param, param._decay, now)\n\t\t\tparam._release = new Ramp(v, finalv, when, when + adsr.release)\n\t\t\tparam._release.run(param)\n\t\t})\n\t}\n\n\trescheduleRamp(param: MAudioParam, ramp: Ramp, now: number): boolean {\n\t\tif (ramp && ramp.inside(now)) {\n\t\t\tramp.cut(now).run(param)\n\t\t\treturn true\n\t\t}\n\t\treturn false\n\t}\n\n\tgetRampValueAtTime(param: MAudioParam, t: number): number | null {\n\t\tlet ramp\n\t\tif (param._attack && param._attack.inside(t))\n\t\t\treturn param._attack.cut(t).v2\n\t\tif (param._decay && param._decay.inside(t))\n\t\t\treturn param._decay.cut(t).v2\n\t\treturn null\n\t}\n\n\tloopParams(cb: (out: MAudioParam) => void): void {\n\t\tfor (const out of this.outTracker.outputs)\n\t\t\tif (out instanceof AudioParam)\n\t\t\t\tcb(<MAudioParam>out)\n\t}\n\n\tgetParamValue(p: MAudioParam): number {\n\t\tif (p._value === undefined) p._value = p.value\n\t\treturn p._value\n\t}\n}\n\n/**\n * Handles note events for any node that allows calling start() after stop(),\n * such as custom nodes.\n */\nexport class RestartableNoteHandler extends BaseNoteHandler {\n\tlastNote: number\n\tplaying = false\n\n\tnoteOn(midi: number, gain: number, ratio: number, when: number): void {\n\t\tconst anode: any = this.ndata.anode\n\t\tif (this.playing)\n\t\t\tanode.stop(when)\n\t\tthis.playing = true\n\t\tanode.start(when)\n\t\tthis.lastNote = midi\n\t}\n\n\tnoteOff(midi: number, gain: number, when: number): void {\n\t\tif (midi != this.lastNote) return\n\t\tthis.playing = false\n\t\tconst anode: any = this.ndata.anode\n\t\tanode.stop(when + this.releaseTime)\n\t}\n}\n\n/**\n * Handles note events for the SoundBank source node\n */\nexport class SoundBankNoteHandler extends BaseNoteHandler {\n\n\tnoteOn(midi: number, gain: number, ratio: number, when: number) {\n\t\tconst bufs = (<any>this.ndata.anode)['_buffers']\n\t\tconst absn = <AudioBufferSourceNode>this.clone()\n\t\tabsn.buffer = bufs[midi % bufs.length]\n\t\tabsn.start(when)\n\t}\n\n\tnoteOff(midi: number, gain: number, when: number) {}\n}\n\n// -------------------- Exported note handlers --------------------\n\n/**\n * Exports available note handlers so they are used by their respective\n * nodes from the palette.\n */\nexport const NoteHandlers = {\n\t'osc': OscNoteHandler,\n\t'buffer': BufferNoteHandler,\n\t'ADSR': ADSRNoteHandler,\n\t'LFO': LFONoteHandler,\n\t'restartable': RestartableNoteHandler,\n\t'soundBank': SoundBankNoteHandler\n}\n\n\n// -------------------- Private classes --------------------\n\n/**\n * Tracks a node output connections and disconnections, to be used\n * when cloning, removing or controlling nodes.\n */\nexport class OutputTracker {\n\toutputs: (AudioNode | AudioParam) [] = []\n\n\tconstructor(anode: AudioNode) {\n\t\tthis.onBefore(anode, 'connect', this.connect, (oldf, obj, args) => {\n\t\t\tif (args[0].custom && args[0].anode) args[0] = args[0].anode\n\t\t\toldf.apply(obj, args)\n\t\t})\n\t\tthis.onBefore(anode, 'disconnect', this.disconnect)\n\t}\n\n\tconnect(np: AudioParam) {\n\t\tthis.outputs.push(np)\n\t}\n\n\tdisconnect(np: AudioParam) {\n\t\tremoveArrayElement(this.outputs, np)\n\t}\n\n\tonBefore(obj: any, fname: string, funcToCall: Function,\n\t\tcb?: (oldf: Function, obj: any, args: any) => void): void {\n\t\tconst oldf = obj[fname]\n\t\tconst self = this\n\t\tobj[fname] = function() {\n\t\t\tfuncToCall.apply(self, arguments)\n\t\t\tif (cb) cb(oldf, obj, arguments)\n\t\t\telse oldf.apply(obj, arguments)\n\t\t}\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/synth/notes.ts","/** Configuration data for an AudioNode parameter */\nexport interface NodeParamDef {\n\tinitial: any\n\tmin?: number\n\tmax?: number\n\tlinear?: boolean\n\tchoices?: string[]\n\thandler?: string\n\tphandler?: any\n}\n\n/** Configuration data for an AudioNode */\nexport interface NodeDef {\n\tconstructor: string | null\n\tcustom?: boolean\n\tnoteHandler?: string\n\tcontrol?: boolean\n\tparams: { [key: string]: NodeParamDef }\n}\n\n/** A set of AudioNode configuration elements */\nexport interface NodePalette {\n\t[key: string]: NodeDef\n}\n\n// -------------------- Node palette definition --------------------\n\nconst OCTAVE_DETUNE: NodeParamDef = {\n\tinitial: 0,\n\tmin: -1200,\n\tmax: 1200,\n\tlinear: true\n}\n\n/**\n * The set of AudioNodes available to the application, along with\n * their configuration.\n */\nexport let palette: NodePalette = {\n\t// Sources\n\tOscillator: {\n\t\tconstructor: 'createOscillator',\n\t\tnoteHandler: 'osc',\n\t\tparams: {\n\t\t\tfrequency: { initial: 220, min: 20, max: 20000 },\n\t\t\tdetune: OCTAVE_DETUNE,\n\t\t\ttype: {\n\t\t\t\tinitial: 'sawtooth',\n\t\t\t\tchoices: ['sine', 'square', 'sawtooth', 'triangle']\n\t\t\t}\n\t\t}\n\t},\n\tBuffer: {\n\t\tconstructor: 'createBufferSource',\n\t\tnoteHandler: 'buffer',\n\t\tparams: {\n\t\t\tplaybackRate: { initial: 1, min: 0, max: 8 },\n\t\t\tdetune: OCTAVE_DETUNE,\n\t\t\tbuffer: {\n\t\t\t\tinitial: null,\n\t\t\t\thandler: 'BufferDataHandler'\n\t\t\t},\n\t\t\tloop: { initial: false },\n\t\t\tloopStart: { initial: 0, min: 0, max: 10 },\n\t\t\tloopEnd: { initial: 3, min: 0, max: 10 }\n\t\t}\n\t},\n\tNoise: {\n\t\tconstructor: 'createNoise',\n\t\tnoteHandler: 'restartable',\n\t\tcustom: true,\n\t\tparams: {\n\t\t\tgain:  { initial: 1, min: 0, max: 10 }\n\t\t}\n\t},\n\tLineIn: {\n\t\tconstructor: 'createLineIn',\n\t\tcustom: true,\n\t\tparams: {}\n\t},\n\tSoundBank: {\n\t\tconstructor: 'createBufferSource',\n\t\tnoteHandler: 'soundBank',\n\t\tparams: {\n\t\t\tbuffer: {\n\t\t\t\tinitial: null,\n\t\t\t\thandler: 'SoundBankHandler'\n\t\t\t}\n\t\t}\n\t},\n\t// Effects\n\tGain: {\n\t\tconstructor: 'createGain',\n\t\tparams: {\n\t\t\tgain: { initial: 1, min: 0, max: 10, linear: true }\n\t\t}\n\t},\n\tFilter: {\n\t\tconstructor: 'createBiquadFilter',\n\t\tparams: {\n\t\t\tfrequency: { initial: 440, min: 20, max: 20000 },\n\t\t\tQ: { initial: 0, min: 0, max: 100 },\n\t\t\tdetune: OCTAVE_DETUNE,\n\t\t\tgain: { initial: 0, min: -40, max: 40, linear: true },\n\t\t\ttype: {\n\t\t\t\tinitial: 'lowpass',\n\t\t\t\tchoices: ['lowpass', 'highpass', 'bandpass',\n\t\t\t\t\t'lowshelf', 'highshelf', 'peaking', 'notch', 'allpass']\n\t\t\t}\n\t\t},\n\t},\n\tDelay: {\n\t\tconstructor: 'createDelay',\n\t\tparams: {\n\t\t\tdelayTime: { initial: 1, min: 0, max: 5 }\n\t\t}\n\t},\n\tStereoPan: {\n\t\tconstructor: 'createStereoPanner',\n\t\tparams: {\n\t\t\tpan: { initial: 0, min: -1, max: 1, linear: true }\n\t\t}\n\t},\n\tCompressor: {\n\t\tconstructor: 'createDynamicsCompressor',\n\t\tparams: {\n\t\t\tthreshold: { initial: -24, min: -100, max: 0, linear: true },\n\t\t\tknee: { initial: 30, min: 0, max: 40, linear: true },\n\t\t\tratio: { initial: 12, min: 1, max: 20, linear: true },\n\t\t\treduction: { initial: 0, min: -20, max: 0, linear: true },\n\t\t\tattack: { initial: 0.003, min: 0, max: 1 },\n\t\t\trelease: { initial: 0.25, min: 0, max: 1 }\n\t\t}\n\t},\n\tDetuner: {\n\t\tconstructor: 'createDetuner',\n\t\tcustom: true,\n\t\tparams: {\n\t\t\toctave: { initial: 0, min: -2, max: 2, linear: true }\n\t\t}\n\t},\n\t// Controllers\n\tLFO: {\n\t\tconstructor: 'createOscillator',\n\t\tnoteHandler: 'LFO',\n\t\tcontrol: true,\n\t\tparams: {\n\t\t\tfrequency: { initial: 5, min: 0.01, max: 200 },\n\t\t\tdetune: OCTAVE_DETUNE,\n\t\t\ttype: {\n\t\t\t\tinitial: 'sine',\n\t\t\t\tchoices: ['sine', 'square', 'sawtooth', 'triangle']\n\t\t\t}\n\t\t}\n\t},\n\tGainCtrl: {\n\t\tconstructor: 'createGain',\n\t\tcontrol: true,\n\t\tparams: {\n\t\t\tgain: { initial: 10, min: 0, max: 100, linear: true }\n\t\t}\n\t},\n\tADSR: {\n\t\tconstructor: 'createADSR',\n\t\tnoteHandler: 'ADSR',\n\t\tcontrol: true,\n\t\tcustom: true,\n\t\tparams: {\n\t\t\tattack:  { initial: 0.2, min: 0, max: 10 },\n\t\t\tdecay:   { initial: 0.5, min: 0, max: 10 },\n\t\t\tsustain: { initial: 0.5, min: 0, max: 1, linear: true },\n\t\t\trelease: { initial: 1.0, min: 0, max: 10 },\n\t\t\tdepth:   { initial: 1.0, min: 0, max: 1 }\n\t\t}\n\t},\n\tNoiseCtrl: {\n\t\tconstructor: 'createNoiseCtrl',\n\t\tcontrol: true,\n\t\tcustom: true,\n\t\tparams: {\n\t\t\tfrequency: { initial: 4, min: 0, max: 200 },\n\t\t\tdepth:  { initial: 20, min: 0, max: 200 }\n\t\t}\n\t},\n\t// Output\n\tSpeaker: {\n\t\tconstructor: null,\n\t\tparams: {}\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/synth/palette.ts","import { ModernAudioNode } from '../utils/modern'\n\n/**\n * Base class to derive all custom nodes from it\n */\nexport class CustomNodeBase implements ModernAudioNode {\n\tcustom = true\n\tchannelCount = 2\n\tchannelCountMode: ChannelCountMode = 'max'\n\tchannelInterpretation: ChannelInterpretation = 'speakers'\n\tcontext: AudioContext\n\tnumberOfInputs = 0\n\tnumberOfOutputs = 1\n\t// Connect - disconnect\n\tconnect(destination: AudioNode | AudioParam,\n\t\toutput?: number, input?: number): AudioNode {\n\t\t\treturn <AudioNode>destination\n\t\t}\n\tdisconnect(destination: AudioNode | AudioParam,\n\t\toutput?: number, input?: number): void {}\n\t// Required for extending EventTarget\n\taddEventListener() {}\n\tdispatchEvent(evt: Event): boolean { return false }\n\tremoveEventListener() {}\n}\n\n\n/**\n * Envelope generator that controls the evolution over time of a destination\n * node's parameter. All parameter control is performed in the corresponding\n * ADSR note handler.\n */\nexport class ADSR extends CustomNodeBase {\n\tattack = 0.2\n\tdecay = 0.5\n\tsustain = 0.5\n\trelease = 1\n\tdepth = 1\n\t// TODO linear / exponential\n}\n\n\n/**\n * Base ScriptProcessor, to derive all custom audio processing nodes from it.\n */\nexport class ScriptProcessor extends CustomNodeBase {\n\tgain = 1\n\tanode: ScriptProcessorNode\n\tplaying = false\n\n\tconstructor(ac: AudioContext) {\n\t\tsuper()\n\t\tthis.anode = ac.createScriptProcessor(1024)\n\t\tthis.anode.onaudioprocess = evt => this.processAudio(evt)\n\t}\n\n\tconnect(node: AudioNode) {\n\t\treturn this.anode.connect(node)\n\t}\n\n\tdisconnect() {\n\t\tthis.anode.disconnect()\n\t}\n\n\tstart() {\n\t\tthis.playing = true\n\t}\n\n\tstop() {\n\t\tthis.playing = false\n\t}\n\n\tprocessAudio(evt: AudioProcessingEvent) {}\n}\n\n\n/**\n * Simple noise generator\n */\nexport class NoiseGenerator extends ScriptProcessor {\n\tprocessAudio(evt: AudioProcessingEvent) {\n\t\tfor (let channel = 0; channel < evt.outputBuffer.numberOfChannels; channel++) {\n\t\t\tconst out = evt.outputBuffer.getChannelData(channel)\n\t\t\tfor (let sample = 0; sample < out.length; sample++)\n\t\t\t\tout[sample] = this.playing ? this.gain * (Math.random() * 2 - 1) : 0\n\t\t}\n\t}\n}\n\n\n/**\n * Noise generator to be used as control node.\n * It uses sample & hold in order to implement the 'frequency' parameter.\n */\nexport class NoiseCtrlGenerator extends ScriptProcessor {\n\tac: AudioContext\n\tfrequency: number\n\tdepth: number\n\tsct: number\n\tv: number\n\n\tconstructor(ac: AudioContext) {\n\t\tsuper(ac)\n\t\tthis.ac = ac\n\t\tthis.frequency = 4\n\t\tthis.depth = 20\n\t\tthis.sct = 0\n\t\tthis.v = 0\n\t}\n\n\tconnect(param: any) {\n\t\treturn this.anode.connect(param)\n\t}\n\n\tprocessAudio(evt: AudioProcessingEvent) {\n\t\tconst samplesPerCycle = this.ac.sampleRate / this.frequency\n\t\tfor (let channel = 0; channel < evt.outputBuffer.numberOfChannels; channel++) {\n\t\t\tlet out = evt.outputBuffer.getChannelData(channel)\n\t\t\tfor (let sample = 0; sample < out.length; sample++) {\n\t\t\t\tthis.sct++\n\t\t\t\tif (this.sct > samplesPerCycle) {\n\t\t\t\t\tthis.v = this.depth * (Math.random() * 2 - 1)\n\t\t\t\t\tthis.sct = 0 // this.sct - Math.floor(this.sct);\n\t\t\t\t}\n\t\t\t\tout[sample] = this.v\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n/**\n * Simple Pitch Shifter implemented in a quick & dirty way\n */\nexport class Detuner extends ScriptProcessor {\n\toctave = 0\n\tnumberOfInputs = 1\n\n\tprocessAudio(evt: AudioProcessingEvent) {\n\t\tconst dx = Math.pow(2, this.octave)\n\t\tfor (let channel = 0; channel < evt.outputBuffer.numberOfChannels; channel++) {\n\t\t\tlet out = evt.outputBuffer.getChannelData(channel)\n\t\t\tlet inbuf = evt.inputBuffer.getChannelData(channel)\n\t\t\tlet sct = 0\n\t\t\tfor (let sample = 0; sample < out.length; sample++) {\n\t\t\t\tout[sample] = inbuf[Math.floor(sct)]\n\t\t\t\tsct += dx\n\t\t\t\tif (sct >= inbuf.length) sct = 0\n\t\t\t}\n\t\t}\n\t}\n}\n\n\n/**\n * Captures audio from the PC audio input.\n * Requires user's authorization to grab audio input.\n */\nexport class LineInNode extends CustomNodeBase {\n\tsrcNode: ModernAudioNode\n\tdstNode: ModernAudioNode\n\tstream: any\n\n\tconnect(anode: any) {\n\t\tif (this.srcNode) {\n\t\t\tthis.srcNode.connect(anode)\n\t\t\tthis.dstNode = anode\n\t\t\treturn anode\n\t\t}\n\t\tconst navigator: any = window.navigator\n\t\tnavigator.getUserMedia = (navigator.getUserMedia ||\n\t\t\tnavigator.webkitGetUserMedia ||\n\t\t\tnavigator.mozGetUserMedia ||\n\t\t\tnavigator.msGetUserMedia)\n\t\tnavigator.getUserMedia({ audio: true }, (stream: any) => {\n\t\t\tconst ac: any = anode.context\n\t\t\tthis.srcNode = ac.createMediaStreamSource(stream)\n\t\t\tlet a2: any = anode\n\t\t\tif (a2.custom && a2.anode) a2 = a2.anode\n\t\t\tthis.srcNode.connect(a2)\n\t\t\tthis.dstNode = anode\n\t\t\tthis.stream = stream\n\t\t}, (error: any) => console.error(error))\n\t}\n\n\tdisconnect() {\n\t\tthis.srcNode.disconnect(this.dstNode)\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/synth/customNodes.ts","/**\n * Main entry point: setup synth editor and keyboard listener.\n */\nimport { SynthUI } from './synthUI/synthUI'\nimport { NoteInputs } from './piano/noteInputs'\nimport { Presets } from './synthUI/presets'\nimport { ModernWindow } from './utils/modern'\nimport { createEditor } from './live-coding/editor'\n\n\nconst graphCanvas = <HTMLCanvasElement>$('#graph-canvas')[0]\nconst ac = createAudioContext()\nconst synthUI = new SynthUI(ac, graphCanvas,\n\t$('#node-params'), $('#audio-graph-fft'), $('#audio-graph-osc'))\n\nconst presets = setupPanels()\n\nfunction createAudioContext(): AudioContext {\n\tconst CtxClass: any = window.AudioContext || window.webkitAudioContext\n\treturn new CtxClass()\n}\n\nfunction setupPanels() {\n\tsetupPalette()\n\tconst inputs = new NoteInputs(synthUI)\n\tconst prsts = new Presets(synthUI)\n\tprsts.beforeSave = (json) => $.extend(json, { keyboard: inputs.piano.toJSON() })\n\tprsts.afterLoad = (json) => inputs.piano.fromJSON(json.keyboard)\n\t$(function() {\n\t\t$('#synth').focus()\n\t})\n\tcreateEditor(ac, prsts)\n\treturn prsts.presets\n}\n\n\nfunction setupPalette() {\n\t$(function() {\n\t\tlet nano: any = $('.nano')\n\t\tnano.nanoScroller({ preventPageScrolling: true })\n\t})\n}\n\n\ndeclare var window: ModernWindow\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.ts","import { Graph, Node, GraphHandler } from './graph'\nimport { Synth, NodeData } from '../synth/synth'\nimport { ModernAudioNode, focusable } from '../utils/modern'\nimport * as popups from '../utils/popups'\n\n/**\n * Customizes the generic graph editor in order to manipulate and control\n * a graph of AudioNodes\n */\nexport class SynthUI {\n\tgr: Graph\n\tsynth: Synth\n\tnw: number\n\tnh: number\n\toutNode: ModernAudioNode\n\n\tconstructor(ac: AudioContext, graphCanvas: HTMLCanvasElement, jqParams: JQuery, jqFFT: JQuery, jqOsc: JQuery) {\n\t\tthis.gr = new Graph(graphCanvas)\n\t\tthis.gr.handler = new SynthGraphHandler(this, jqParams, jqFFT, jqOsc)\n\t\tthis.synth = new Synth(ac)\n\t\tthis.registerPaletteHandler()\n\t\tthis.addOutputNode()\n\t}\n\n\taddOutputNode() {\n\t\t// TODO avoid using hardcoded position\n\t\tconst out = new Node(500, 210, 'Out')\n\t\tout.data = new GraphNodeData(out)\n\t\tthis.synth.initOutputNodeData(out.data, this.synth.ac.destination)\n\t\tthis.outNode = out.data.anode\n\t\tthis.gr.addNode(out, 'node-out')\n\t\tthis.initNodeDimensions(out)\n\t}\n\n\tregisterPaletteHandler() {\n\t\tlet self = this\t// JQuery sets 'this' in event handlers\n\t\t$('.palette .node').click(function(evt) {\n\t\t\tlet elem = $(this)\n\t\t\tlet classAttr = elem.attr('class') || ''\n\t\t\tlet classes = classAttr.split(/\\s+/).filter(c => c != 'node')\n\t\t\tlet type = elem.attr('data-type')\n\t\t\tif (!type) return\n\t\t\tself.addNode(type,\n\t\t\t\telem.find('.node-text').html(), classes.join(' '))\n\t\t})\n\t}\n\n\taddNode(type: string, text: string, classes: string): void {\n\t\tlet { x, y } = this.findFreeSpot()\n\t\tconst n = new Node(x, y, text)\n\t\tthis.createNodeData(n, type)\n\t\tthis.gr.addNode(n, classes)\n\t\tthis.gr.selectNode(n)\n\t}\n\n\tremoveNode(n: Node): void {\n\t\tthis.gr.removeNode(n)\n\t}\n\n\tremoveNodeData(data: NodeData): void {\n\t\tthis.synth.removeNodeData(data)\n\t}\n\n\tcreateNodeData(n: Node, type: string): void {\n\t\tn.data = new GraphNodeData(n)\n\t\tif (type == 'out') {\n\t\t\tthis.synth.initOutputNodeData(n.data, this.synth.ac.destination)\n\t\t\tthis.outNode = n.data.anode\n\t\t}\n\t\telse\n\t\t\tthis.synth.initNodeData(n.data, type)\n\t}\n\n\t// ----- Rest of methods are used to find a free spot in the canvas -----\n\n\tfindFreeSpot() {\n\t\tlet maxDist = 0\n\t\tconst canvasW = this.gr.canvas.width\n\t\tconst canvasH = this.gr.canvas.height\n\t\tlet x = canvasW / 2\n\t\tlet y = canvasH / 2\n\t\tfor (let xx = 10; xx < canvasW - this.nw; xx += 10) {\n\t\t\tfor (let yy = 10; yy < canvasH - this.nh; yy += 10) {\n\t\t\t\tconst dist = this.dist2nearestNode(xx, yy)\n\t\t\t\tif (dist > maxDist && dist < this.nw * 3) {\n\t\t\t\t\tx = xx\n\t\t\t\t\ty = yy\n\t\t\t\t\tmaxDist = dist\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn { x, y }\n\t}\n\n\tdist2nearestNode(x: number, y: number) {\n\t\tlet minDist = Number.MAX_VALUE\n\t\tfor (const n of this.gr.nodes) {\n\t\t\tconst dx = x - n.x\n\t\t\tconst dy = y - n.y\n\t\t\tconst dist = Math.sqrt(dx * dx + dy * dy)\n\t\t\tif (dist < minDist) minDist = dist\n\t\t}\n\t\treturn minDist\n\t}\n\n\tinitNodeDimensions(n: Node) {\n\t\tthis.nw = n.element.outerWidth() || 0\n\t\tthis.nh = n.element.outerHeight() || 0\n\t}\n\n}\n\n\n// -------------------- Privates --------------------\n\nimport { NodeDef } from '../synth/palette'\nimport { renderParams } from './paramsUI'\nimport { AudioAnalyzer } from './analyzer'\n\n\nclass GraphNodeData extends NodeData {\n\tnode: Node\n\tconstructor(node: Node) {\n\t\tsuper()\n\t\tthis.node = node\n\t}\n\tgetInputs(): NodeData[] {\n\t\tconst result: NodeData[] = []\n\t\tfor (const nin of this.node.inputs)\n\t\t\tresult.push(nin.data)\n\t\treturn result\n\t}\n}\n\nclass SynthGraphHandler implements GraphHandler {\n\n\tsynthUI: SynthUI\n\tjqParams: JQuery\n\tarrowColor: string\n\tctrlArrowColor: string\n\tanalyzer: AudioAnalyzer\n\n\tconstructor(synthUI: SynthUI, jqParams: JQuery, jqFFT: JQuery, jqOsc: JQuery) {\n\t\tthis.synthUI = synthUI\n\t\tthis.jqParams = jqParams\n\t\tthis.arrowColor = getCssFromClass('arrow', 'color')\n\t\tthis.ctrlArrowColor = getCssFromClass('arrow-ctrl', 'color')\n\t\tthis.registerNodeDelete(jqParams.parent()[0])\n\t\tthis.analyzer = new AudioAnalyzer(jqFFT, jqOsc)\n\t}\n\n\tregisterNodeDelete(elem: HTMLElement) {\n\t\t$(focusable(elem)).keydown((evt: any) => {\n\t\t\tif (!(evt.keyCode == 46 || (evt.keyCode == 8 && evt.metaKey))) return\n\t\t\tif (popups.isOpen) return\n\t\t\tconst selectedNode = this.getSelectedNode()\n\t\t\tif (!selectedNode) return\n\t\t\tif (selectedNode.data.isOut) return\n\t\t\tpopups.confirm('Delete node?',\n\t\t\t\t'Please confirm node deletion', confirmed => {\n\t\t\t\tif (!confirmed) return\n\t\t\t\tthis.synthUI.removeNode(selectedNode)\n\t\t\t\tthis.jqParams.empty()\n\t\t\t})\n\t\t})\n\t}\n\n\tgetSelectedNode(): Node | null {\n\t\tfor (const node of this.synthUI.gr.nodes)\n\t\t\tif (node.element.hasClass('selected')) return node\n\t\treturn null\n\t}\n\n\thasAudioParams(ndata: NodeData) {\n\t\tconst aparams = Object.keys(ndata.nodeDef.params)\n\t\t\t.filter(pname => (<any>ndata).anode[pname] instanceof AudioParam)\n\t\treturn aparams.length > 0\n\t}\n\n\t// --------------- Implementation of the GraphHandler interface ---------------\n\tcanBeSource(n: Node): boolean {\n\t\tconst data: NodeData = n.data\n\t\treturn data.anode != this.synthUI.outNode\n\t}\n\n\tcanConnect(src: Node, dst: Node): boolean {\n\t\tconst srcData: NodeData = src.data\n\t\tconst dstData: NodeData = dst.data\n\t\tif (srcData.nodeDef.control)\n\t\t\treturn this.hasAudioParams(dstData)\n\t\treturn dstData.anode.numberOfInputs > 0\n\t}\n\n\tconnected(src: Node, dst: Node): void {\n\t\tthis.synthUI.synth.connectNodes(src.data, dst.data)\n\t\t// TODO update paramsUI in case selected node is src\n\t}\n\n\tdisconnected(src: Node, dst: Node): void {\n\t\tthis.synthUI.synth.disconnectNodes(src.data, dst.data)\n\t}\n\n\tnodeSelected(n: Node): void {\n\t\tconst data: NodeData = n.data\n\t\trenderParams(data, this.jqParams)\n\t}\n\n\tnodeRemoved(n: Node) {\n\t\tthis.synthUI.removeNodeData(n.data)\n\t}\n\n\tgetArrowColor(src: Node, dst: Node): string {\n\t\tconst srcData: NodeData = src.data\n\t\treturn srcData.nodeDef.control ? this.ctrlArrowColor : this.arrowColor\n\t}\n\n\tdata2json(n: Node): any {\n\t\treturn this.synthUI.synth.nodeData2json(n.data)\n\t}\n\n\tjson2data(n: Node, json: any): void {\n\t\tthis.synthUI.createNodeData(n, json.type)\n\t\tthis.synthUI.synth.json2NodeData(json, n.data)\n\t}\n\n\tgraphLoaded() {\n\t\tthis.analyzer.analyze(this.synthUI.outNode)\n\t}\n\n\tgraphSaved() {}\n}\n\n\nfunction getCssFromClass(className: string, propName: string) {\n\tconst tmp = $('<div>').addClass(className)\n\t$('body').append(tmp)\n\tconst propValue = tmp.css(propName)\n\ttmp.remove()\n\treturn propValue\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/synthUI/synthUI.ts","const SHIFT_KEY = 16\nconst CAPS_LOCK = 20\n\n/**\n * A generic directed graph editor.\n */\nexport class Graph {\n\n\tnodeCanvas: JQuery\n\tcanvas: HTMLCanvasElement\n\tnodes: Node[] = []\n\tgraphDraw: GraphDraw\n\tgraphInteract: GraphInteraction\n\thandler: GraphHandler\n\tlastId = 0\n\n\tconstructor(canvas: HTMLCanvasElement) {\n\t\tif (!canvas.parentElement) return\n\t\tthis.nodeCanvas = $(canvas.parentElement)\n\t\tthis.canvas = canvas\n\t\tconst gc = canvas.getContext('2d')\n\t\tif (!gc) return\n\t\tthis.graphDraw = new GraphDraw(this, gc, canvas)\n\t\tthis.graphInteract = new GraphInteraction(this, gc)\n\t\tthis.handler = new DefaultGraphHandler()\n\t}\n\n\taddNode(n: Node, classes?: string) {\n\t\tn.id = this.lastId++\n\t\tn.element = $('<div>')\n\t\t\t.addClass('node')\n\t\t\t.html(`<div class=\"node-text\">${n.name}</div>`)\n\t\t\t.css({ left: n.x, top: n.y, cursor: 'default' })\n\t\tif (classes) n.element.addClass(classes)\n\t\tthis.nodeCanvas.append(n.element)\n\t\tthis.nodes.push(n)\n\t\tthis.graphInteract.registerNode(n)\n\t\tthis.draw()\n\t}\n\n\tremoveNode(n: Node): void {\n\t\tconst pos = this.nodes.indexOf(n)\n\t\tif (pos < 0)\n\t\t\treturn console.warn(`Node '${n.name}' is not a member of graph`)\n\t\tfor (const nn of this.nodes) {\n\t\t\tif (n == nn) continue\n\t\t\tthis.disconnect(n, nn)\n\t\t\tthis.disconnect(nn, n)\n\t\t}\n\t\tthis.nodes.splice(pos, 1)\n\t\tn.element.remove()\n\t\tthis.handler.nodeRemoved(n)\n\t\tthis.draw()\n\t}\n\n\tselectNode(n: Node) {\n\t\tthis.graphInteract.selectNode(n)\n\t}\n\n\tconnect(srcn: Node, dstn: Node): boolean {\n\t\tif (!this.handler.canBeSource(srcn) || !this.handler.canConnect(srcn, dstn))\n\t\t\treturn false\n\t\tdstn.addInput(srcn)\n\t\tthis.handler.connected(srcn, dstn)\n\t\treturn true\n\t}\n\n\tdisconnect(srcn: Node, dstn: Node): boolean {\n\t\tif (!dstn.removeInput(srcn)) return false\n\t\tthis.handler.disconnected(srcn, dstn)\n\t\treturn true\n\t}\n\n\tdraw() {\n\t\tthis.graphDraw.draw()\n\t}\n\n\ttoJSON(): any {\n\t\tconst jsonNodes = []\n\t\tconst jsonNodeData = []\n\t\tfor (const node of this.nodes) {\n\t\t\tconst nodeInputs = []\n\t\t\tfor (const nin of node.inputs)\n\t\t\t\tnodeInputs.push(nin.id)\n\t\t\tjsonNodes.push({\n\t\t\t\tid: node.id,\n\t\t\t\tx: node.x,\n\t\t\t\ty: node.y,\n\t\t\t\tname: node.name,\n\t\t\t\tinputs: nodeInputs,\n\t\t\t\tclasses: this.getAppClasses(node)\n\t\t\t})\n\t\t\tjsonNodeData.push(this.handler.data2json(node))\n\t\t}\n\t\tconst jsonGraph = {\n\t\t\tnodes: jsonNodes,\n\t\t\tnodeData: jsonNodeData\n\t\t}\n\t\tthis.handler.graphSaved()\n\t\treturn jsonGraph\n\t}\n\n\tfromJSON(json: any) {\n\t\t// First, remove existing nodes\n\t\twhile (this.nodes.length > 0)\n\t\t\tthis.removeNode(this.nodes[0])\n\t\tthis.lastId = 0\n\t\t// Then add nodes\n\t\tfor (const jn of json.nodes) {\n\t\t\tconst node = new Node(jn.x, jn.y, jn.name)\n\t\t\tthis.addNode(node)\n\t\t\tnode.id = jn.id\t// Override id after being initialized inside addNode\n\t\t\tnode.element.attr('class', jn.classes)\n\t\t}\n\t\t// Then connect them\n\t\tconst gh = this.handler\n\t\tthis.handler = new DefaultGraphHandler()\t// Disable graph handler\n\t\tfor (let i = 0; i < json.nodes.length; i++) {\n\t\t\tfor (const inum of json.nodes[i].inputs) {\n\t\t\t\tconst src = this.nodeById(inum)\n\t\t\t\tif (src) this.connect(src, this.nodes[i])\n\t\t\t}\n\t\t}\n\t\tthis.handler = gh\t// Restore graph handler\n\t\t// Then set their data\n\t\tfor (let i = 0; i < json.nodes.length; i++) {\n\t\t\tthis.handler.json2data(this.nodes[i], json.nodeData[i])\n\t\t}\n\t\t// Then notify connections to handler\n\t\tfor (const dst of this.nodes)\n\t\t\tfor (const src of dst.inputs)\n\t\t\t\tthis.handler.connected(src, dst)\n\t\t// And finally, draw the new graph\n\t\tthis.draw()\n\t\tthis.handler.graphLoaded()\n\t}\n\n\tnodeById(id: number): Node | null {\n\t\tfor (const node of this.nodes)\n\t\t\tif (node.id === id) return node\n\t\treturn null\n\t}\n\n\tgetAppClasses(n: Node): string {\n\t\tconst classes = n.element[0].className.split(/\\s+/)\n\t\tconst result = []\n\t\tfor (const cname of classes) {\n\t\t\tif (cname == 'selected') continue\n\t\t\tif (cname.substr(0, 3) == 'ui-') continue\n\t\t\tresult.push(cname)\n\t\t}\n\t\treturn result.join(' ')\n\t}\n}\n\n/**\n * A node in the graph. Application-specific data can be attached\n * to its data property.\n */\nexport class Node {\n\tid: number\n\tx: number\n\ty: number\n\tname: string\n\tinputs: Node[] = []\n\telement: JQuery\n\tw: number\n\th: number\n\tdata: any\n\n\tconstructor(x: number, y: number, name: string) {\n\t\tthis.x = x\n\t\tthis.y = y\n\t\tthis.name = name.replace(/<[^<]*>/g, t => t == '<br>' ? t : '')\n\t}\n\n\taddInput(n: Node) {\n\t\tthis.inputs.push(n)\n\t}\n\n\tremoveInput(n: Node): boolean {\n\t\tconst pos: number = this.inputs.indexOf(n)\n\t\tif (pos < 0) return false\n\t\tthis.inputs.splice(pos, 1)\n\t\treturn true\n\t}\n\n}\n\n/**\n * A set of callbacks to be implemented by the application in order\n * to customize the graph editor and add application-specific behavior.\n */\nexport interface GraphHandler {\n\tcanBeSource(n: Node): boolean\n\tcanConnect(src: Node, dst: Node): boolean\n\tconnected(src: Node, dst: Node): void\n\tdisconnected(src: Node, dst: Node): void\n\tnodeSelected(n: Node): void\n\tnodeRemoved(n: Node): void\n\tgetArrowColor(src: Node, dst: Node): string\n\tdata2json(n: Node): any\n\tjson2data(n: Node, json: any): void\n\tgraphLoaded(): void\n\tgraphSaved(): void\n}\n\n\n// ------------------------- Privates -------------------------\n\n/** Default, do-nothing GraphHandler implementation */\nclass DefaultGraphHandler implements GraphHandler {\n\tcanBeSource(n: Node): boolean { return true }\n\tcanConnect(src: Node, dst: Node): boolean { return true }\n\tconnected(src: Node, dst: Node): void {}\n\tdisconnected(src: Node, dst: Node): void {}\n\tnodeSelected(n: Node): void {}\n\tnodeRemoved(n: Node): void {}\n\tgetArrowColor(src: Node, dst: Node): string { return 'black' }\n\tdata2json(n: Node): any { return {} }\n\tjson2data(n: Node, json: any): void {}\n\tgraphLoaded(): void {}\n\tgraphSaved(): void {}\n}\n\n/**\n * Handles all UI interaction with graph in order to move, select, connect\n * and disconnect nodes.\n */\nexport class GraphInteraction {\n\n\tgraph: Graph\n\tgc: CanvasRenderingContext2D\n\tdragging = false\n\tselectedNode: Node\n\n\tconstructor(graph: Graph, gc: CanvasRenderingContext2D) {\n\t\tthis.graph = graph\n\t\tthis.gc = gc\n\t\tthis.setupConnectHandler(gc.canvas)\n\t}\n\n\tregisterNode(n: Node) {\n\t\t(<any>n.element).draggable({\n\t\t\tcontainment: 'parent',\n\t\t\tdistance: 5,\n\t\t\tstack: '.node',\n\t\t\tdrag: (event: Event, ui: any) => {\n\t\t\t\tn.x = ui.position.left\n\t\t\t\tn.y = ui.position.top\n\t\t\t\tthis.graph.draw()\n\t\t\t},\n\t\t\tstart: (event: Event, ui: any) => {\n\t\t\t\tthis.dragging = true\n\t\t\t\tui.helper.css('cursor', 'move')\n\t\t\t},\n\t\t\tstop: (event: Event, ui: any) => {\n\t\t\t\tui.helper.css('cursor', 'default')\n\t\t\t\tthis.dragging = false\n\t\t\t}\n\t\t})\n\t\tn.element.click(_ => {\n\t\t\tif (this.dragging) return\n\t\t\tif (this.selectedNode == n) return\n\t\t\tthis.selectNode(n)\n\t\t})\n\t}\n\n\tselectNode(n: Node): void {\n\t\tif (this.selectedNode)\n\t\t\tthis.selectedNode.element.removeClass('selected')\n\t\tn.element.addClass('selected')\n\t\tthis.selectedNode = n\n\t\tthis.graph.handler.nodeSelected(n)\n\t}\n\n\tsetupConnectHandler(elem: HTMLElement | null) {\n\t\tif (!elem) return\n\t\tlet srcn: Node | null\n\t\tlet connecting = false\n\t\twhile (elem != null && elem.tabIndex < 0\n\t\t\t&& elem.nodeName.toLowerCase() != 'body')\n\t\t\telem = elem.parentElement\n\t\tif (!elem) return\n\t\t$(elem).keydown(evt => {\n\t\t\tif (evt.keyCode == CAPS_LOCK) return this.setGrid([20, 20])\n\t\t\tif (evt.keyCode != SHIFT_KEY || connecting) return\n\t\t\tsrcn = this.getNodeFromDOM(this.getElementUnderMouse())\n\t\t\tif (!srcn) return\n\t\t\tif (!this.graph.handler.canBeSource(srcn)) {\n\t\t\t\tsrcn.element.css('cursor', 'not-allowed')\n\t\t\t\treturn\n\t\t\t}\n\t\t\tconnecting = true\n\t\t\tthis.registerRubberBanding(srcn)\n\t\t})\n\t\t.keyup(evt => {\n\t\t\tif (evt.keyCode == CAPS_LOCK) return this.setGrid(null)\n\t\t\tif (evt.keyCode != SHIFT_KEY) return\n\t\t\tconnecting = false\n\t\t\tthis.deregisterRubberBanding()\n\t\t\tconst dstn = this.getNodeFromDOM(this.getElementUnderMouse())\n\t\t\tif (!dstn || srcn == dstn) return\n\t\t\tif (srcn) this.connectOrDisconnect(srcn, dstn)\n\t\t\tthis.graph.draw()\n\t\t})\n\t}\n\n\tsetGrid(grid: any): void {\n\t\t$(this.graph.nodeCanvas).find('.node').draggable( 'option', 'grid', grid)\n\t}\n\n\tconnectOrDisconnect(srcn: Node, dstn: Node) {\n\t\tif (this.graph.disconnect(srcn, dstn)) return\n\t\telse this.graph.connect(srcn, dstn)\n\t}\n\n\tgetElementUnderMouse(): JQuery | null {\n\t\tconst hovered = $(':hover')\n\t\tif (hovered.length <= 0) return null\n\t\tconst jqNode = $(hovered.get(hovered.length - 1))\n\t\tif (jqNode.hasClass('node')) return jqNode\n\t\tif (jqNode.parent().hasClass('node')) return jqNode.parent()\n\t\treturn null\n\t}\n\n\tregisterRubberBanding(srcn: Node) {\n\t\tconst ofs = this.graph.nodeCanvas.offset()\n\t\tif (!ofs) return\n\t\tconst dstn = new Node(0, 0, '')\n\t\tdstn.w = 0\n\t\tdstn.h = 0\n\t\t$(this.graph.nodeCanvas).on('mousemove', evt => {\n\t\t\tif (!evt) return\n\t\t\tlet cltx = evt.clientX || 0\n\t\t\tlet clty = evt.clientY || 0\n\t\t\tdstn.x = cltx - ofs.left\n\t\t\tdstn.y = clty - ofs.top + ($('body').scrollTop() || 0)\n\t\t\tthis.graph.draw()\n\t\t\tthis.gc.save()\n\t\t\tthis.gc.setLineDash([10])\n\t\t\tthis.graph.graphDraw.drawArrow(srcn, dstn)\n\t\t\tthis.gc.restore()\n\t\t})\n\t\t// Setup cursors\n\t\tthis.graph.nodeCanvas.css('cursor', 'crosshair')\n\t\tthis.graph.nodeCanvas.find('.node').css('cursor', 'crosshair')\n\t\tfor (const n of this.graph.nodes)\n\t\t\tif (n != srcn && !this.graph.handler.canConnect(srcn, n))\n\t\t\t\tn.element.css('cursor', 'not-allowed')\n\t}\n\n\tderegisterRubberBanding() {\n\t\tthis.graph.nodeCanvas.css('cursor', '')\n\t\tthis.graph.nodeCanvas.find('.node').css('cursor', 'default')\n\t\tthis.graph.nodeCanvas.off('mousemove')\n\t\tthis.graph.graphDraw.draw()\n\t}\n\n\tgetNodeFromDOM(jqNode: JQuery | null) {\n\t\tif (!jqNode) return null\n\t\tfor (const n of this.graph.nodes)\n\t\t\tif (n.element[0] == jqNode[0]) return n\n\t\treturn null\n\t}\n}\n\n\nexport interface Point {\n\tx: number,\n\ty: number\n}\n\n\n/**\n * Handles graph drawing by rendering arrows in a canvas.\n */\nexport class GraphDraw {\n\n\tgraph: Graph\n\tgc: CanvasRenderingContext2D\n\tcanvas: HTMLCanvasElement\n\tarrowHeadLen = 10\n\tnodes: Node[]\n\n\tconstructor(graph: Graph, gc: CanvasRenderingContext2D, canvas: HTMLCanvasElement) {\n\t\tthis.graph = graph\n\t\tthis.gc = gc\n\t\tthis.canvas = canvas\n\t\tthis.nodes = graph.nodes\n\t}\n\n\tdraw() {\n\t\tthis.clearCanvas()\n\t\tthis.gc.lineWidth = 2\n\t\tfor (const ndst of this.nodes)\n\t\t\tfor (const nsrc of ndst.inputs)\n\t\t\t\tthis.drawArrow(nsrc, ndst)\n\t}\n\n\tclearCanvas() {\n\t\tthis.gc.clearRect(0, 0, this.canvas.width, this.canvas.height)\n\t}\n\n\tdrawArrow(srcNode: Node, dstNode: Node) {\n\t\tconst srcPoint = this.getNodeCenter(srcNode)\n\t\tconst dstPoint = this.getNodeCenter(dstNode)\n\t\tthis.gc.strokeStyle = this.graph.handler.getArrowColor(srcNode, dstNode)\n\t\tthis.gc.beginPath()\n\t\tthis.gc.moveTo(srcPoint.x, srcPoint.y)\n\t\tthis.gc.lineTo(dstPoint.x, dstPoint.y)\n\t\tthis.drawArrowTip(srcPoint, dstPoint)\n\t\tthis.gc.closePath()\n\t\tthis.gc.stroke()\n\t}\n\n\tdrawArrowTip(src: Point, dst: Point) {\n\t\tconst posCoef = 0.6\n\t\tconst mx = src.x + (dst.x - src.x) * posCoef\n\t\tconst my = src.y + (dst.y - src.y) * posCoef\n\t\tlet angle = Math.atan2(dst.y - src.y, dst.x - src.x)\n\t\tthis.gc.moveTo(mx, my)\n\t\tthis.gc.lineTo(\n\t\t\tmx - this.arrowHeadLen * Math.cos(angle - Math.PI / 6),\n\t\t\tmy - this.arrowHeadLen * Math.sin(angle - Math.PI / 6)\n\t\t)\n\t\tthis.gc.moveTo(mx, my)\n\t\tthis.gc.lineTo(\n\t\t\tmx - this.arrowHeadLen * Math.cos(angle + Math.PI / 6),\n\t\t\tmy - this.arrowHeadLen * Math.sin(angle + Math.PI / 6)\n\t\t)\n\t}\n\n\tgetNodeCenter(n: Node): Point {\n\t\tn.w = n.w !== undefined ? n.w : n.element.outerWidth() || 0\n\t\tn.h = n.h !== undefined ? n.h : n.element.outerHeight() || 0\n\t\treturn { x: n.x + n.w / 2, y: n.y + n.h / 2 }\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/synthUI/graph.ts","import { Node } from './graph'\nimport { NodeData } from '../synth/synth'\nimport { NodeDef, NodeParamDef } from '../synth/palette'\nimport { log2linear, linear2log } from '../utils/modern'\nimport * as file from '../utils/file'\nimport * as popups from '../utils/popups'\n\n/**\n * Renders the UI controls associated with the parameters of a given node\n */\nexport function renderParams(ndata: NodeData, panel: JQuery): void {\n\tpanel.empty()\n\tconst boxes: JQuery[] = []\n\tif (ndata.nodeDef.control && ndata.controlParams) {\n\t\tlet box = renderParamControl(ndata, panel)\n\t\tif (box) boxes.push(box)\n\t}\n\tconst params = Object.keys(ndata.nodeDef.params || {})\n\tif (params.length <= 0) return\n\tfor (const param of params)\n\t\tif ((<any>ndata.anode)[param] instanceof AudioParam) {\n\t\t\tboxes.push(renderAudioParam(ndata.anode, ndata.nodeDef, param, panel))\n\t\t}\n\t\telse {\n\t\t\tlet box = renderOtherParam(ndata.anode, ndata.nodeDef, param, panel)\n\t\t\tif (box) boxes.push(box)\n\t\t}\n\tpositionBoxes(panel, boxes)\n}\n\n\nfunction positionBoxes(panel: JQuery, boxes: JQuery[]) {\n\tif (boxes.length < 1) return\n\tconst pw = panel.width() || 0\n\tconst bw = boxes[0].width() || 0\n\tconst sep = (pw - boxes.length * bw) / (boxes.length + 1)\n\tlet x = sep\n\tfor (const box of boxes) {\n\t\tbox.css({\n\t\t\tposition: 'relative',\n\t\t\tleft: x\n\t\t})\n\t\tx += sep\n\t}\n}\n\nfunction renderAudioParam(anode: AudioNode, ndef: NodeDef, param: string, panel: JQuery): JQuery {\n\tconst pdef: NodeParamDef = ndef.params[param]\n\tconst aparam: any = (<any>anode)[param]\n\tif (aparam['_value']) aparam.value = aparam['_value']\n\treturn renderSlider(panel, pdef, param, aparam.value, value => {\n\t\taparam.value = value\n\t\taparam['_value'] = value\n\t})\n}\n\nfunction renderParamControl(ndata: NodeData, panel: JQuery): JQuery | null {\n\tif (!ndata.controlParams) return null\n\tconst combo = renderCombo(panel, ndata.controlParams, ndata.controlParam, 'Controlling')\n\tcombo.change(_ => {\n\t\tif (ndata.controlParam)\n\t\t\tndata.anode.disconnect((<any>ndata.controlTarget)[ndata.controlParam])\n\t\tndata.controlParam = '' + combo.val()\n\t\tndata.anode.connect((<any>ndata.controlTarget)[ndata.controlParam])\n\t})\n\treturn combo.parent()\n}\n\nconst customRenderMethods = {\n\trenderBufferData,\n\trenderSoundBank\n}\n\nfunction renderOtherParam(anode: any, ndef: NodeDef,\n\tparam: string, panel: JQuery): JQuery | null {\n\tconst pdef: NodeParamDef = ndef.params[param]\n\tif (pdef.choices) {\n\t\tconst combo = renderCombo(panel, pdef.choices, anode[param], ucfirst(param))\n\t\tcombo.change(_ => {\n\t\t\tanode[param] = combo.val()\n\t\t})\n\t\treturn combo.parent()\n\t}\n\telse if (pdef.min != undefined)\n\t\treturn renderSlider(panel, pdef, param, anode[param], value => anode[param] = value)\n\telse if (typeof pdef.initial == 'boolean')\n\t\treturn renderBoolean(panel, pdef, param, anode, ucfirst(param))\n\telse if (pdef.phandler)\n\t\treturn (<any>customRenderMethods)[pdef.phandler.uiRender](panel, pdef, anode, param, ucfirst(param))\n\treturn null\n}\n\n\nfunction renderSlider(panel: JQuery, pdef: NodeParamDef,\n\tparam: string, value: number, setValue: (value: number) => void): JQuery {\n\tconst sliderBox = $('<div class=\"slider-box\">')\n\tconst slider = $('<input type=\"range\" orient=\"vertical\">')\n\t\t.attr('min', 0)\n\t\t.attr('max', 1)\n\t\t.attr('step', 0.001)\n\t\t.attr('value', param2slider(value, pdef))\n\tconst numInput = $('<input type=\"number\">')\n\t\t.attr('min', pdef.min || 0)\n\t\t.attr('max', pdef.max || 1)\n\t\t.attr('value', truncateFloat(value, 5))\n\tsliderBox.append(numInput)\n\tsliderBox.append(slider)\n\tsliderBox.append($('<span><br/>' + ucfirst(param) + '</span>'))\n\tpanel.append(sliderBox)\n\tslider.on('input', _ => {\n\t\tconst v = slider2param(parseFloat('' + slider.val()), pdef)\n\t\tnumInput.val(truncateFloat(v, 5))\n\t\tsetValue(v)\n\t})\n\tnumInput.on('input', _ => {\n\t\tconst v = parseFloat('' + numInput.val())\n\t\tif (isNaN(v)) return\n\t\tslider.val(param2slider(v, pdef))\n\t\tsetValue(v)\n\t})\n\treturn sliderBox\n}\n\nfunction renderCombo(panel: JQuery, choices: string[], selected: string, label: string): JQuery {\n\tconst choiceBox = $('<div class=\"choice-box\">')\n\tconst combo = $('<select>').attr('size', choices.length || 2)\n\tfor (const choice of choices) {\n\t\tconst option = $('<option>').text(choice)\n\t\tif (choice == selected) option.attr('selected', 'selected')\n\t\tcombo.append(option)\n\t}\n\tchoiceBox.append(combo)\n\tcombo.after('<br/><br/>' + label)\n\tpanel.append(choiceBox)\n\treturn combo\n}\n\nfunction renderBoolean(panel: JQuery, pdef: NodeParamDef, param: string,\n\tanode: any, label: string): JQuery {\n\tconst box = $('<div class=\"choice-box\">')\n\tconst button = $('<button class=\"btn btn-info\" data-toggle=\"button\" aria-pressed=\"false\">')\n\tbox.append(button)\n\tbutton.after('<br/><br/>' + label)\n\tpanel.append(box)\n\tif (anode[param]) {\n\t\tbutton.text('Enabled')\n\t\tbutton.addClass('active')\n\t\tbutton.attr('aria-pressed', 'true')\n\t}\n\telse {\n\t\tbutton.text('Disabled')\n\t\tbutton.removeClass('active')\n\t\tbutton.attr('aria-pressed', 'false')\n\t}\n\tbutton.click(_ => {\n\t\tanode[param] = !anode[param]\n\t\tbutton.text(anode[param] ? 'Enabled' : 'Disabled')\n\t})\n\treturn box\n}\n\n\nfunction param2slider(paramValue: number, pdef: NodeParamDef): number {\n\tlet min = pdef.min || 0\n\tlet max = pdef.max || 1\n\tif (pdef.linear)\n\t\treturn (paramValue - min) / (max - min)\n\telse\n\t\treturn linear2log(paramValue, min, max)\n}\n\nfunction slider2param(sliderValue: number, pdef: NodeParamDef): number {\n\tlet min = pdef.min || 0\n\tlet max = pdef.max || 1\n\tif (pdef.linear)\n\t\treturn min + sliderValue * (max - min)\n\telse\n\t\treturn log2linear(sliderValue, min, max)\n}\n\n\n// -------------------- Custom parameter rendering --------------------\n\nfunction renderBufferData(panel: JQuery, pdef: NodeParamDef,\n\tanode: any, param: string, label: string): JQuery {\n\tconst box = $('<div class=\"choice-box\">')\n\tconst button = $(`\n\t\t<span class=\"btn btn-primary upload\">\n\t\t\t<input type=\"file\">\n\t\t\tLoad&nbsp;\n\t\t\t<span class=\"glyphicon glyphicon-open\" aria-hidden=\"true\"></span>\n\t\t</span>`)\n\tbox.append(button)\n\tbutton.after('<br/><br/>' + label)\n\tpanel.append(box)\n\tlet loading = true\n\tbutton.find('input').change(evt => {\n\t\t// Trigger asynchronous upload & decode\n\t\tfile.uploadArrayBuffer(evt, soundFile => {\n\t\t\tanode['_encoded'] = soundFile\n\t\t\tanode.context.decodeAudioData(soundFile, (buffer: any) => {\n\t\t\t\tanode['_buffer'] = buffer\n\t\t\t\tloading = false\n\t\t\t\t// TODO capture errors and report them with popups.alert\n\t\t\t\tpopups.close()\n\t\t\t})\n\t\t})\n\t\t// Open progress popup\n\t\tsetTimeout(_ => {\n\t\t\tif (loading)\n\t\t\t\tpopups.progress('Loading and decoding audio data...')\n\t\t}, 300)\n\t})\n\treturn box\n}\n\nfunction setComboOptions(combo: JQuery, names: string[]) {\n\tcombo.empty()\n\tfor (const name of names)\n\t\tcombo.append('<option>' + name + '</option>')\n}\n\nfunction renderSoundBank(panel: JQuery, pdef: NodeParamDef,\n\tanode: any, param: string, label: string): JQuery {\n\tconst combo = renderCombo(panel, [], '', 'Buffers')\n\tcombo.css({\n\t\tmarginBottom: '10px', marginLeft: '-20px',\n\t\twidth: '140px', height: '100px',\n\t\toverflowX: 'auto'\n\t})\n\tconst buttons = $(`<div style=\"margin-bottom: -24px\">\n\t\t<span class=\"btn btn-primary upload\">\n\t\t\t<input type=\"file\">\n\t\t\t<span class=\"glyphicon glyphicon-open\" aria-hidden=\"true\"></span>\n\t\t</span>\n\t\t&nbsp;&nbsp;&nbsp;\n\t\t<span class=\"btn btn-danger\">\n\t\t\t<span class=\"glyphicon glyphicon-trash\" aria-hidden=\"true\"></span>\n\t\t</span></div>`)\n\tcombo.after(buttons)\n\tconst bufs = anode['_buffers']\n\tconst encs = anode['_encodedBuffers']\n\tconst names = anode['_names']\n\tsetComboOptions(combo, names)\n\tbuttons.find('input').change(evt => {\n\t\t// Trigger asynchronous upload & decode\n\t\tfile.uploadArrayBuffer(evt, (fileData, f) => {\n\t\t\tencs.push(fileData)\n\t\t\tanode.context.decodeAudioData(fileData,\n\t\t\t\t(buffer: any) => bufs.push(buffer))\n\t\t\tnames.push(f.name)\n\t\t\tsetComboOptions(combo, names)\n\t\t})\n\t})\n\tbuttons.find('.btn-danger').click(_ => {\n\t\tconst idx = names.indexOf(combo.val())\n\t\tif (idx < 0) return\n\t\t[encs, bufs, names].forEach(a => a.splice(idx, 1))\n\t\tsetComboOptions(combo, names)\n\t})\n\treturn combo.parent()\n}\n\n// -------------------- Misc utilities --------------------\n\nfunction ucfirst(str: string) {\n\treturn str[0].toUpperCase() + str.substring(1)\n}\n\nfunction truncateFloat(f: number, len: number): string {\n\tlet s: string = '' + f\n\ts = s.substr(0, len)\n\tif (s[s.length - 1] == '.') return s.substr(0, len - 1)\n\telse return s\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/synthUI/paramsUI.ts","import { ModernAudioNode } from '../utils/modern'\n\n/**\n * Displays FFT and Oscilloscope graphs from the output of a given AudioNode\n */\nexport class AudioAnalyzer {\n\tinput: ModernAudioNode | null\n\tanode: AnalyserNode\n\tcanvasFFT: HTMLCanvasElement\n\tgcFFT: CanvasRenderingContext2D | null\n\tcanvasOsc: HTMLCanvasElement\n\tgcOsc: CanvasRenderingContext2D | null\n\toscData: Uint8Array\n\tfftData: Uint8Array\n\n\tconstructor(jqfft: JQuery, jqosc: JQuery) {\n\t\tthis.canvasFFT = this.createCanvas(jqfft)\n\t\tthis.gcFFT = this.canvasFFT.getContext('2d')\n\t\tthis.canvasOsc = this.createCanvas(jqosc)\n\t\tthis.gcOsc = this.canvasOsc.getContext('2d')\n\t}\n\n\tcreateCanvas(panel: JQuery): HTMLCanvasElement {\n\t\tconst jqCanvas = $(`<canvas width=\"${panel.width()}\" height=\"${panel.height()}\">`)\n\t\tpanel.append(jqCanvas)\n\t\tconst canvas = <HTMLCanvasElement>jqCanvas[0]\n\t\treturn canvas\n\t}\n\n\tcreateAnalyzerNode(ac: AudioContext) {\n\t\tif (this.anode) return\n\t\tthis.anode = ac.createAnalyser()\n\t\tthis.fftData = new Uint8Array(this.anode.fftSize)\n\t\tthis.oscData = new Uint8Array(this.anode.fftSize)\n\t}\n\n\tanalyze(input: AudioNode) {\n\t\tthis.disconnect()\n\t\tthis.createAnalyzerNode(input.context)\n\t\tthis.input = input\n\t\tthis.input.connect(this.anode)\n\t\tthis.requestAnimationFrame()\n\t}\n\n\tdisconnect() {\n\t\tif (!this.input) return\n\t\tthis.input.disconnect(this.anode)\n\t\tthis.input = null\n\t}\n\n\trequestAnimationFrame() {\n\t\twindow.requestAnimationFrame(_ => this.updateCanvas())\n\t}\n\tupdateCanvas() {\n\t\tif (!this.input) return\n\t\tif (this.gcFFT)\n\t\t\tthis.drawFFT(this.gcFFT, this.canvasFFT, this.fftData, '#00FF00')\n\t\tif (this.gcOsc)\n\t\t\tthis.drawOsc(this.gcOsc, this.canvasOsc, this.oscData, '#FFFF00')\n\t\tthis.requestAnimationFrame()\n\t}\n\n\tdrawFFT(gc: CanvasRenderingContext2D, canvas: HTMLCanvasElement,\n\t\t\tdata: Uint8Array, color: string) {\n\t\tconst [w, h] = this.setupDraw(gc, canvas, data, color)\n\t\tthis.anode.getByteFrequencyData(data)\n\t\tconst dx = (data.length / 2) / canvas.width\n\t\tlet x = 0\n\t\t// TODO calculate average of all samples from x to x + dx - 1\n\t\tfor (let i = 0; i < w; i++) {\n\t\t\tlet y = data[Math.floor(x)]\n\t\t\tx += dx\n\t\t\tgc.moveTo(i, h - 1)\n\t\t\tgc.lineTo(i, h - 1 - h * y / 256)\n\t\t}\n\t\tgc.stroke()\n\t\tgc.closePath()\n\t}\n\n\tdrawOsc(gc: CanvasRenderingContext2D, canvas: HTMLCanvasElement,\n\t\tdata: Uint8Array, color: string) {\n\t\tconst [w, h] = this.setupDraw(gc, canvas, data, color)\n\t\tthis.anode.getByteTimeDomainData(data)\n\t\tgc.moveTo(0, h / 2)\n\t\tlet x = 0\n\t\twhile (data[x] > 128 && x < data.length / 4) x++\n\t\twhile (data[x] < 128 && x < data.length / 4) x++\n\t\tconst dx = (data.length * 0.75) / canvas.width\n\t\tfor (let i = 0; i < w; i++) {\n\t\t\tlet y = data[Math.floor(x)]\n\t\t\tx += dx\n\t\t\tgc.lineTo(i, h * y / 256)\n\t\t}\n\t\tgc.stroke()\n\t\tgc.closePath()\n\t}\n\n\tsetupDraw(gc: CanvasRenderingContext2D, canvas: HTMLCanvasElement,\n\t\tdata: Uint8Array, color: string) {\n\t\tconst w = canvas.width\n\t\tconst h = canvas.height\n\t\tgc.clearRect(0, 0, w, h)\n\t\tgc.beginPath()\n\t\tgc.strokeStyle = color\n\t\treturn [w, h]\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/synthUI/analyzer.ts","import { Keyboard } from './keyboard'\nimport { MidiKeyboard } from './midi'\nimport { PianoKeyboard } from './piano'\nimport { Arpeggiator } from './arpeggiator'\n\nimport { NodeData } from '../synth/synth'\nimport { SynthUI } from '../synthUI/synthUI'\nimport { Instrument } from '../synth/instrument'\n\nconst NUM_VOICES = 8\n\n/**\n * Manages all note-generation inputs:\n * \t- PC Keyboard\n * \t- Virtual piano keyboard\n *\t- An external MIDI keyboard\n * Handles switching to polyphonic mode and back to mono\n */\nexport class NoteInputs {\n\tsynthUI: SynthUI\n\tpoly: boolean\n\tinstrument: Instrument\n\tlastNote: number\n\tpiano: PianoKeyboard\n\tarpeggiator: Arpeggiator\n\n\tconstructor(synthUI: SynthUI) {\n\t\tthis.synthUI = synthUI\n\t\tthis.poly = false\n\t\t// Setup piano panel\n\t\tlet piano = new PianoKeyboard($('#piano'))\n\t\tthis.piano = piano\n\t\tpiano.noteOn = (midi) => this.arpeggiator.sendNoteOn(midi, 1)\n\t\tpiano.noteOff = (midi) => this.arpeggiator.sendNoteOff(midi, 1)\n\t\t// Register poly on/off handlers\n\t\tpiano.polyOn = () => this.polyOn()\n\t\tpiano.polyOff = () => this.polyOff()\n\t\t// Setup PC keyboard\n\t\tlet kb = this.setupPCKeyboard(piano)\n\t\t// Bind piano octave with PC keyboard\n\t\tkb.baseNote = piano.baseNote\n\t\tpiano.octaveChanged = baseNote => kb.baseNote = baseNote\n\t\tthis.setupEnvelopeAnimation(piano)\n\t\t// Setup arpeggiator\n\t\tthis.setupArpeggiator(piano, synthUI.synth.ac)\n\t\t// Setup MIDI keyboard\n\t\tthis.setupMidiKeyboard(piano)\n\t}\n\n\tsetupPCKeyboard(piano: PianoKeyboard): Keyboard {\n\t\tlet kb = new Keyboard('#synth')\n\t\tkb.noteOn = (midi) => {\n\t\t\tif (document.activeElement.nodeName == 'INPUT' &&\n\t\t\t\tdocument.activeElement.getAttribute('type') != 'range') return\n\t\t\tthis.arpeggiator.sendNoteOn(midi, 1)\n\t\t\tpiano.displayKeyDown(midi)\n\t\t}\n\t\tkb.noteOff = (midi) => {\n\t\t\tthis.arpeggiator.sendNoteOff(midi, 1)\n\t\t\tpiano.displayKeyUp(midi)\n\t\t}\n\t\treturn kb\n\t}\n\n\tsetupMidiKeyboard(piano: PianoKeyboard) {\n\t\tlet midi = new MidiKeyboard()\n\t\tmidi.noteOn = (note: number, velocity: number, channel: number): void => {\n\t\t\tthis.arpeggiator.sendNoteOn(note, 1)\n\t\t\tpiano.displayKeyDown(note)\n\t\t}\n\t\tmidi.noteOff = (note: number, velocity: number, channel: number): void => {\n\t\t\tthis.arpeggiator.sendNoteOff(note, 1)\n\t\t\tpiano.displayKeyUp(note)\n\t\t}\n\t}\n\n\tsetupEnvelopeAnimation(piano: PianoKeyboard) {\n\t\tconst loaded = this.synthUI.gr.handler.graphLoaded\n\t\tthis.synthUI.gr.handler.graphLoaded = function() {\n\t\t\tloaded.bind(this.synthUI.gr.handler)()\n\t\t\tlet adsr = null\n\t\t\tfor (const node of this.synthUI.gr.nodes) {\n\t\t\t\tconst data: NodeData = node.data\n\t\t\t\tif (data.type == 'ADSR') {\n\t\t\t\t\tadsr = data.anode\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t}\n\t\t\tpiano.setEnvelope(adsr || { attack: 0, release: 0 })\n\t\t}\n\t}\n\n\tsetupArpeggiator(piano: PianoKeyboard, ac: AudioContext) {\n\t\tthis.arpeggiator = new Arpeggiator(ac)\n\t\tpiano.arpeggioChanged = (bpm, mode, octaves) => {\n\t\t\tthis.arpeggiator.mode = mode\n\t\t\tthis.arpeggiator.octaves = octaves\n\t\t\tthis.arpeggiator.bpm = bpm\n\t\t}\n\t\tthis.arpeggiator.noteOn =\n\t\t\t(midi, velocity, time) => this.noteOn(midi, velocity, time)\n\t\tthis.arpeggiator.noteOff =\n\t\t\t(midi, velocity, time) => this.noteOff(midi, velocity, time)\n\t}\n\n\n\tnoteOn(midi: number, velocity: number, time?: number): void {\n\t\tthis.lastNote = midi\n\t\tconst portamento = this.piano.getPortamento()\n\t\tif (this.poly) {\n\t\t\tthis.instrument.portamento.time = portamento\n\t\t\tthis.instrument.noteOn(midi, velocity, time)\n\t\t}\n\t\telse {\n\t\t\tthis.synthUI.synth.portamento.time = portamento\n\t\t\tthis.synthUI.synth.noteOn(midi, velocity, time)\n\t\t}\n\t}\n\n\tnoteOff(midi: number, velocity: number, time?: number): void {\n\t\tthis.lastNote = 0\n\t\tif (this.poly)\n\t\t\tthis.instrument.noteOff(midi, velocity, time)\n\t\telse\n\t\t\tthis.synthUI.synth.noteOff(midi, velocity, time)\n\t}\n\n\tpolyOn() {\n\t\tif (this.lastNote) this.noteOff(this.lastNote, 1)\n\t\tthis.poly = true\n\t\tconst json = this.synthUI.gr.toJSON()\n\t\tthis.instrument = new Instrument(this.synthUI.synth.ac, json, NUM_VOICES)\n\t}\n\n\tpolyOff() {\n\t\tthis.poly = false\n\t\tthis.instrument.close()\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/piano/noteInputs.ts","const KB_NOTES = 'ZSXDCVGBHNJMQ2W3ER5T6Y7UI9O0P'\nconst BASE_NOTE = 36\n\n/**\n * Provides a piano keyboard using the PC keyboard.\n * Listens to keyboard events and generates MIDI-style noteOn/noteOff events.\n */\nexport class Keyboard {\n\n\tbaseNote: number\n\n\tconstructor(kbTarget = 'body') {\n\t\tthis.setupHandler(kbTarget)\n\t\tthis.baseNote = BASE_NOTE\n\t}\n\n\tsetupHandler(kbTarget: string) {\n\t\tconst pressedKeys: any = {}\n\t\t$(kbTarget)\n\t\t.on('keydown', evt => {\n\t\t\tlet kcode = evt.keyCode || 0\n\t\t\tif (pressedKeys[kcode]) return\t\t\t\t\t// Skip repetitions\n\t\t\tif (evt.metaKey || evt.altKey || evt.ctrlKey) return\t// Skip browser shortcuts\n\t\t\tpressedKeys[kcode] = true\n\t\t\tconst midi = this.key2midi(kcode)\n\t\t\tif (midi < 0) return\n\t\t\tthis.noteOn(midi)\n\t\t})\n\t\t.on('keyup', evt => {\n\t\t\tlet kcode = evt.keyCode || 0\n\t\t\tpressedKeys[kcode] = false\n\t\t\tconst midi = this.key2midi(kcode)\n\t\t\tif (midi < 0) return\n\t\t\tthis.noteOff(midi)\n\t\t})\n\t}\n\n\tkey2midi(keyCode: number): number {\n\t\tconst pos = KB_NOTES.indexOf(String.fromCharCode(keyCode))\n\t\tif (pos < 0) return -1\n\t\treturn this.baseNote + pos\n\t}\n\n\tnoteOn(midi: number): void {}\n\tnoteOff(midi: number): void {}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/piano/keyboard.ts","export class MidiKeyboard {\n\tconnected = false\n\n\tconstructor() {\n\t\tif (!navigator.requestMIDIAccess) return\n\t\tnavigator.requestMIDIAccess({ sysex: false })\n\t\t.then((midiAccess: any) => {\n\t\t\tif (midiAccess.inputs.size <= 0) return\n\t\t\tconst input = midiAccess.inputs.values().next().value\n\t\t\tif (!input) return\n\t\t\tinput.onmidimessage = (msg: any) => this.midiMessage(msg)\n\t\t\tthis.connected = true\n\t\t})\n\t}\n\n\tmidiMessage(msg: any) {\n\t\tconst data = msg.data\n\t\tconst cmd = data[0] >> 4\n\t\tconst channel = data[0] & 0xf\n\t\tconst note = data[1]\n\t\tconst velocity = data[2]\n\t\tswitch (cmd) {\n\t\t\tcase 9:\n\t\t\t\tthis.noteOn(note, velocity, channel)\n\t\t\t\tbreak\n\t\t\tcase 8:\n\t\t\t\tthis.noteOff(note, velocity, channel)\n\t\t\t\tbreak\n\t\t}\n\t}\n\n\tnoteOn(midi: number, velocity: number, channel: number): void {}\n\tnoteOff(midi: number, velocity: number, channel: number): void {}\n}\n\ndeclare var navigator: any\n\n\n\n// WEBPACK FOOTER //\n// ./src/piano/midi.ts","import * as popups from '../utils/popups'\nimport { log2linear, linear2log } from '../utils/modern'\n\nconst NUM_WHITES = 17\nconst BASE_NOTE = 36\n\nconst ARPEGGIO_MODES = ['', 'u', 'd', 'ud']\nconst ARPEGGIO_LABELS = ['-', '&uarr;', '&darr;', '&uarr;&darr;']\nconst MAX_ARPEGGIO_OCT = 3\nconst ARPEGGIO_MIN = 15\nconst ARPEGGIO_MAX = 480\n\nconst PORTAMENTO_MIN = 0\nconst PORTAMENTO_MAX = 1\n\n\n/** Builds a piano keyboard out of DIVs */\nexport class PianoKeys {\n\tconstructor(public numWhites = NUM_WHITES) {}\n\n\tcreateKeys(panel: JQuery): JQuery[] {\n\t\tconst keys = []\n\t\tconst pw = panel.width() || 0\n\t\tconst ph = panel.height() || 0\n\t\tconst fromX = parseFloat(panel.css('padding-left'))\n\t\tconst fromY = parseFloat(panel.css('padding-top'))\n\t\tconst kw = pw / this.numWhites + 1\n\t\tconst bw = Math.round(kw * 2 / 3)\n\t\tconst bh = Math.round(ph * 2 / 3)\n\t\t// Create white keys\n\t\tlet knum = 0\n\t\tfor (let i = 0; i < this.numWhites; i++) {\n\t\t\tconst key = $('<div class=\"piano-key\">').css({\n\t\t\t\twidth: '' + kw + 'px',\n\t\t\t\theight: '' + ph + 'px'\n\t\t\t})\n\t\t\tpanel.append(key)\n\t\t\tkeys[knum++] = key\n\t\t\tif (this.hasBlack(i)) knum++\n\t\t}\n\t\t// Create black keys\n\t\tknum = 0\n\t\tlet x = fromX - bw / 2\n\t\tfor (let i = 0; i < this.numWhites - 1; i++) {\n\t\t\tx += kw - 1\n\t\t\tknum++\n\t\t\tif (!this.hasBlack(i)) continue\n\t\t\tconst key = $('<div class=\"piano-key piano-black\">').css({\n\t\t\t\twidth: '' + bw + 'px',\n\t\t\t\theight: '' + bh + 'px',\n\t\t\t\tleft: '' + x + 'px',\n\t\t\t\ttop: '' + fromY + 'px'\n\t\t\t})\n\t\t\tpanel.append(key)\n\t\t\tkeys[knum++] = key\n\t\t}\n\t\treturn keys\n\t}\n\n\thasBlack(num: number): boolean {\n\t\tconst mod7 = num % 7\n\t\treturn mod7 != 2 && mod7 != 6\n\t}\n\n}\n\n/**\n * A virtual piano keyboard that:\n * \t- Captures mouse input and generates corresponding note events\n * \t- Displays note events as CSS-animated colors in the pressed keys\n * \t- Supports octave switching\n * \t- Provides a poly/mono button\n */\nexport class PianoKeyboard {\n\tkeys: JQuery[]\n\tk1note: number\n\tbaseNote: number\n\toctave: number\n\tpoly: boolean\n\tlastKey: JQuery\n\tenvelope: { attack: number; release: number }\n\tportaSlider: JQuery\n\tcontrols: JQuery\n\tarpeggio = {\n\t\tmode: 0,\n\t\toctave: 1,\n\t\tbpm: 60\n\t}\n\n\tconstructor(panel: JQuery) {\n\t\tthis.baseNote = BASE_NOTE\n\t\tthis.octave = 3\n\t\tthis.poly = false\n\t\tthis.envelope = { attack: 0, release: 0 }\n\t\tconst pianoKeys = new PianoKeys()\n\t\tthis.keys = pianoKeys.createKeys(panel)\n\t\tfor (let i = 0; i < this.keys.length; i++)\n\t\t\tthis.registerKey(this.keys[i], i)\n\t\tthis.controls = panel.parent()\n\t\tthis.registerButtons(this.controls)\n\t\tthis.portaSlider = this.controls.find('.portamento-box input')\n\t}\n\n\tregisterKey(key: JQuery, knum: number): void {\n\t\tkey.mousedown(_ => {\n\t\t\tconst midi = knum + this.baseNote\n\t\t\tthis.displayKeyDown(key)\n\t\t\tthis.noteOn(midi)\n\t\t})\n\t\tkey.mouseup(_ => {\n\t\t\tconst midi = knum + this.baseNote\n\t\t\tthis.displayKeyUp(key)\n\t\t\tthis.noteOff(midi)\n\t\t})\n\t}\n\n\tregisterButtons(panel: JQuery): void {\n\t\t// Octave navigation\n\t\t$('#prev-octave-but').click(_ => {\n\t\t\tthis.octave--\n\t\t\tthis.updateOctave()\n\t\t})\n\t\t$('#next-octave-but').click(_ => {\n\t\t\tthis.octave++\n\t\t\tthis.updateOctave()\n\t\t})\n\t\t// Arpeggio\n\t\tconst arpeggioSlider = panel.find('.arpeggio-box input')\n\t\tarpeggioSlider.on('input', _ => {\n\t\t\tthis.arpeggio.bpm =\n\t\t\t\tlog2linear(parseFloat('' + arpeggioSlider.val()), ARPEGGIO_MIN, ARPEGGIO_MAX)\n\t\t\t\t// ARPEGGIO_MIN + parseFloat(arpeggioSlider.val()) * (ARPEGGIO_MAX - ARPEGGIO_MIN);\n\t\t\tthis.triggerArpeggioChange()\n\t\t})\n\t\tconst butArpMode = panel.find('.btn-arpeggio-ud')\n\t\tbutArpMode.click(_ => this.changeArpeggioMode(butArpMode))\n\t\tconst butArpOct = panel.find('.btn-arpeggio-oct')\n\t\tbutArpOct.click(_ => this.changeArpeggioOctave(butArpOct))\n\t\t// Monophonic / polyphonic mode\n\t\t$('#poly-but').click(_ => this.togglePoly())\n\t}\n\n\tupdateOctave() {\n\t\t$('#prev-octave-but').prop('disabled', this.octave <= 1)\n\t\t$('#next-octave-but').prop('disabled', this.octave >= 8)\n\t\t$('#octave-label').text('C' + this.octave)\n\t\tthis.baseNote = BASE_NOTE + 12 * (this.octave - 3)\n\t\tthis.octaveChanged(this.baseNote)\n\t}\n\n\tdisplayKeyDown(key: any): void {\n\t\tif (typeof key == 'number') key = this.midi2key(key)\n\t\tif (!key) return\n\t\tif (!this.poly && this.arpeggio.mode == 0 && this.lastKey)\n\t\t\tthis.displayKeyUp(this.lastKey, true)\n\t\tkey.css('transition', `background-color ${this.envelope.attack}s linear`)\n\t\tkey.addClass('piano-key-pressed')\n\t\tthis.lastKey = key\n\t}\n\n\tdisplayKeyUp(key: any, immediate?: boolean) {\n\t\tif (typeof key == 'number') key = this.midi2key(key)\n\t\tif (!key) return\n\t\tconst release = immediate ? 0 : this.envelope.release\n\t\tkey.css('transition', `background-color ${release}s linear`)\n\t\tkey.removeClass('piano-key-pressed')\n\t}\n\n\tmidi2key(midi: number) {\n\t\treturn this.keys[midi - this.baseNote]\n\t}\n\n\tsetEnvelope(adsr: any) {\n\t\tthis.envelope = adsr\n\t}\n\n\ttogglePoly() {\n\t\tthis.poly = !this.poly\n\t\tif (this.poly) {\n\t\t\tconst cover = $('<div>').addClass('editor-cover')\n\t\t\tcover.append('<p>You can use the PC keyboard to play notes<br><br>' +\n\t\t\t\t'Synth editing is disabled in polyphonic mode</p>')\n\t\t\t$('body').append(cover)\n\t\t\t$('#poly-but').text('Poly')\n\t\t\tpopups.setOpen(true)\n\t\t\tthis.polyOn()\n\t\t}\n\t\telse {\n\t\t\t$('.editor-cover').remove()\n\t\t\t$('#poly-but').text('Mono')\n\t\t\tpopups.setOpen(false)\n\t\t\tthis.polyOff()\n\t\t}\n\t}\n\n\tgetPortamento(): number {\n\t\tconst sv = parseFloat('' + this.portaSlider.val())\n\t\treturn log2linear(sv, PORTAMENTO_MIN, PORTAMENTO_MAX)\n\t}\n\n\tchangeArpeggioMode(button: JQuery) {\n\t\tthis.arpeggio.mode++\n\t\tif (this.arpeggio.mode >= ARPEGGIO_MODES.length)\n\t\t\tthis.arpeggio.mode = 0\n\t\tbutton.html(ARPEGGIO_LABELS[this.arpeggio.mode])\n\t\tthis.triggerArpeggioChange()\n\t}\n\n\tchangeArpeggioOctave(button: JQuery) {\n\t\tthis.arpeggio.octave++\n\t\tif (this.arpeggio.octave > MAX_ARPEGGIO_OCT)\n\t\t\tthis.arpeggio.octave = 1\n\t\tbutton.text(this.arpeggio.octave)\n\t\tthis.triggerArpeggioChange()\n\t}\n\n\ttriggerArpeggioChange() {\n\t\tthis.arpeggioChanged(this.arpeggio.bpm,\n\t\t\tARPEGGIO_MODES[this.arpeggio.mode], this.arpeggio.octave)\n\t}\n\n\ttoJSON(): any {\n\t\treturn {\n\t\t\tportamento: this.getPortamento(),\n\t\t\toctave: this.octave,\n\t\t\tarpeggio: {\n\t\t\t\tbpm: this.arpeggio.bpm,\n\t\t\t\tmode: this.arpeggio.mode,\n\t\t\t\toctave: this.arpeggio.octave\n\t\t\t}\n\t\t}\n\t}\n\n\tfromJSON(json: any): void {\n\t\tif (!json) return\n\t\tif (json.portamento) {\n\t\t\tthis.portaSlider.val(\n\t\t\t\tlinear2log(json.portamento, PORTAMENTO_MIN, PORTAMENTO_MAX))\n\t\t}\n\t\tif (json.octave) {\n\t\t\tthis.octave = json.octave\n\t\t\tthis.updateOctave()\n\t\t}\n\t\tif (json.arpeggio) {\n\t\t\tthis.arpeggio.bpm = json.arpeggio.bpm\n\t\t\tthis.arpeggio.mode = json.arpeggio.mode\n\t\t\tthis.arpeggio.octave = json.arpeggio.octave\n\t\t\tthis.controls.find('.arpeggio-box input').val(\n\t\t\t\tlinear2log(this.arpeggio.bpm, ARPEGGIO_MIN, ARPEGGIO_MAX))\n\t\t\tthis.controls.find('.btn-arpeggio-ud').html(ARPEGGIO_LABELS[this.arpeggio.mode])\n\t\t\tthis.controls.find('.btn-arpeggio-oct').text(this.arpeggio.octave)\n\t\t\tthis.triggerArpeggioChange()\n\t\t}\n\t}\n\n\t// Simple event handlers\n\tnoteOn(midi: number): void {}\n\tnoteOff(midi: number): void {}\n\tpolyOn() {}\n\tpolyOff() {}\n\toctaveChanged(baseNote: number) {}\n\tarpeggioChanged(bpm: number, mode: string, octaves: number) {}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/piano/piano.ts","import { Timer } from '../synth/timer'\n\nexport class Arpeggiator {\n\tmode: string\n\toctaves: number\n\t_bpm: number\n\tnotes: NoteTable\n\tnotect: number\n\tbackward = false\n\ttimer: Timer\n\tnoteOnTime = 0.75\n\n\tconstructor(ac: AudioContext) {\n\t\tthis.mode = ''\n\t\tthis.octaves = 1\n\t\tthis.bpm = 60\n\t\tthis.notect = 0\n\t\tthis.notes = new NoteTable()\n\t\tthis.timer = new Timer(ac, this.bpm)\n\t}\n\n\tget bpm() { return this._bpm }\n\n\tset bpm(v) {\n\t\tthis._bpm = v\n\t\tif (this.timer) this.timer.bpm = v\n\t}\n\n\ttimerCB(time: number): void {\n\t\t// Return if disabled or no notes\n\t\tif (this.mode.length == 0) return\n\t\tconst len = this.notes.length()\n\t\tif (len == 0) return\n\t\t// Check note counter\n\t\tthis.wrapCounter(len)\n\t\t// Get current note and play it\n\t\tconst ndata = this.notes.get(this.notect)\n\t\tthis.noteOn(ndata.noteToPlay, ndata.velocity, time)\n\t\tthis.noteOff(ndata.noteToPlay, ndata.velocity,\n\t\t\ttime + this.timer.noteDuration * this.noteOnTime)\n\t\t// Update note counter\n\t\tif (this.mode == 'u')\n\t\t\tthis.notect++\n\t\telse if (this.mode == 'd')\n\t\t\tthis.notect--\n\t\telse if (this.mode == 'ud') {\n\t\t\tif (this.backward) this.notect--\n\t\t\telse this.notect++\n\t\t}\n\t}\n\n\twrapCounter(len: number) {\n\t\tif (this.notect >= len) {\n\t\t\tif (this.mode != 'ud')\n\t\t\t\tthis.notect = 0\n\t\t\telse {\n\t\t\t\tthis.backward = true\n\t\t\t\tthis.notect = len < 2 ? 0 : len - 2\n\t\t\t}\n\t\t}\n\t\telse if (this.notect < 0) {\n\t\t\tif (this.mode != 'ud')\n\t\t\t\tthis.notect = len - 1\n\t\t\telse {\n\t\t\t\tthis.backward = false\n\t\t\t\tthis.notect = len < 2 ? 0 : 1\n\t\t\t}\n\t\t}\n\t}\n\n\tsendNoteOn(midi: number, velocity: number): void {\n\t\tif (this.mode.length == 0)\n\t\t\treturn this.noteOn(midi, velocity)\n\t\tconst shouldStart = this.notes.length() == 0\n\t\tthis.notes.add(midi, midi, velocity)\n\t\tif (this.octaves > 1)\n\t\t\tthis.notes.add(midi, midi + 12, velocity)\n\t\tif (this.octaves > 2)\n\t\t\tthis.notes.add(midi, midi + 24, velocity)\n\t\tif (shouldStart)\n\t\t\tthis.timer.start(time => this.timerCB(time))\n\t}\n\n\tsendNoteOff(midi: number, velocity: number): void {\n\t\tif (this.mode.length == 0)\n\t\t\tthis.noteOff(midi, velocity)\n\t\tthis.notes.remove(midi)\n\t\tif (this.notes.length() == 0) {\n\t\t\tthis.timerCB(0)\n\t\t\tthis.timer.stop()\n\t\t\tthis.backward = false\n\t\t\tthis.notect = 0\n\t\t}\n\t}\n\n\t// Event handlers\n\tnoteOn(midi: number, velocity: number, time?: number): void {}\n\tnoteOff(midi: number, velocity: number, time?: number): void {}\n}\n\n\nexport class NoteData {\n\tconstructor(public note: number,\n\t\tpublic noteToPlay: number, public velocity: number) {}\n}\n\nexport class NoteTable {\n\tprivate notes: NoteData[] = []\n\n\tlength(): number { return this.notes.length }\n\n\tget(i: number): NoteData { return this.notes[i] }\n\n\tadd(note: number, noteToPlay: number, velocity: number): void {\n\t\tconst ndata = new NoteData(note, noteToPlay, velocity)\n\t\tfor (let i = 0; i < this.notes.length; i++) {\n\t\t\tif (noteToPlay < this.notes[i].noteToPlay) {\n\t\t\t\tthis.notes.splice(i, 0, ndata)\n\t\t\t\treturn\n\t\t\t}\n\t\t}\n\t\tthis.notes.push(ndata)\n\t}\n\n\tremove(note: number): void {\n\t\tthis.notes = this.notes.filter(ndata => ndata.note != note)\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/piano/arpeggiator.ts","import { SynthUI } from './synthUI'\nimport * as popups from '../utils/popups'\nimport * as file from '../utils/file'\nimport { focusable } from '../utils/modern'\nimport { Node } from './graph'\n\nconst MAX_PRESETS = 20\n\n/**\n * Manages the presets box:\n * - Handles navigation through presets\n * - Handles preset loading & saving\n */\nexport class Presets {\n\n\tsynthUI: SynthUI\n\tpresets: any[]\n\tpresetNum = 0\n\n\tconstructor(synthUI: SynthUI) {\n\t\tthis.synthUI = synthUI\n\t\tthis.registerListeners(synthUI.gr.canvas)\n\t\tthis.loadPresets()\n\t}\n\n\tloadPresets() {\n\t\tthis.presets = new Array(MAX_PRESETS)\n\t\tfor (let i = 0; i < MAX_PRESETS; i++)\n\t\t\tthis.presets[i] = this.getEmptyPreset()\n\t\t$.get('js/presets.json', data => {\n\t\t\tif (!(data instanceof Array)) return\n\t\t\tfor (let i = 0; i < MAX_PRESETS; i++)\n\t\t\t\tif (data[i]) this.presets[i] = data[i]\n\t\t\tthis.preset2synth()\n\t\t})\n\t}\n\n\tgetEmptyPreset(): any {\n\t\treturn {\n\t\t\tname: '',\n\t\t\tnodes: [\n\t\t\t\t{ id: 0, x: 500, y: 180, name: 'Out', inputs: [], classes: 'node node-out' }\n\t\t\t],\n\t\t\tnodeData: [\n\t\t\t\t{ type: 'out', params: {} }\n\t\t\t]\n\t\t}\n\t}\n\n\tregisterListeners(elem: HTMLElement) {\n\t\t$('#save-but').click(_ => this.savePreset())\n\t\t$('#load-file').on('change', evt => this.loadPreset(evt))\n\t\t$('#prev-preset-but').click(_ => this.changePreset(this.presetNum - 1))\n\t\t$('#next-preset-but').click(_ => this.changePreset(this.presetNum + 1))\n\t\t$(focusable(elem)).keydown(evt => {\n\t\t\tif (evt.target.nodeName == 'INPUT' || popups.isOpen) return\n\t\t\tif (evt.keyCode == 37) this.changePreset(this.presetNum - 1)\n\t\t\tif (evt.keyCode == 39) this.changePreset(this.presetNum + 1)\n\t\t})\n\t\t$('#preset-num').click(_ => this.togglePresetSelector())\n\t\tconst preSel = $('.preset-selector select')\n\t\tpreSel.change(_ => {\n\t\t\tlet val = preSel.val()\n\t\t\tif (!val) return\n\t\t\tconst sel = val.toString().split(':')[0]\n\t\t\tthis.changePreset(parseInt(sel, 10) - 1)\n\t\t})\n\t}\n\n\ttogglePresetSelector() {\n\t\tconst seldiv = $('.preset-selector')\n\t\tseldiv.toggle()\n\t\tif (!seldiv.is(':visible')) return\n\t\t// Fill select contents\n\t\tthis.synth2preset()\n\t\tconst sel = seldiv.find('select')\n\t\tsel.empty()\n\t\tsel.focus()\n\t\tlet i = 0\n\t\tfor (const preset of this.presets) {\n\t\t\tconst selected = i == this.presetNum ? ' selected' : ''\n\t\t\ti++\n\t\t\tif (preset.nodes.length > 1)\n\t\t\t\tsel.append(`<option${selected}>${i}: ${preset.name}</option>`)\n\t\t}\n\t}\n\n\tchangePreset(newNum: number) {\n\t\tif (newNum < 0) newNum = MAX_PRESETS - 1\n\t\telse if (newNum >= MAX_PRESETS) newNum = 0\n\t\tthis.synth2preset()\n\t\tthis.presetNum = newNum\n\t\tthis.preset2synth()\n\t}\n\n\tsynth2preset() {\n\t\tconst json = this.synthUI.gr.toJSON()\n\t\tlet val = '' + $('#preset-name').val()\n\t\tjson.name = val.trim()\n\t\tjson.modulatorType = 'synth'\n\t\tthis.beforeSave(json)\n\t\tthis.presets[this.presetNum] = json\n\t\treturn json\n\t}\n\n\tpreset2synth() {\n\t\tconst preset = this.presets[this.presetNum]\n\t\tthis.afterLoad(preset)\n\t\t$('#preset-num').text(this.presetNum + 1)\n\t\t$('#preset-name').val(preset.name)\n\t\t$('#node-params').empty()\n\t\tthis.synthUI.gr.fromJSON(preset)\n\t\tthis.selectBestNode()\n\t}\n\n\tselectBestNode() {\n\t\ttype Predicate = (n: Node) => boolean\n\t\tconst getFirstNode =\n\t\t\t(isGood: Predicate) => this.synthUI.gr.nodes.filter(isGood)[0]\n\t\tlet n = getFirstNode(nn => nn.data.type == 'Filter')\n\t\tif (!n) n = getFirstNode(nn => nn.data.type == 'ADSR')\n\t\tif (!n) n = getFirstNode(nn => nn.data.anode.numberOfInputs == 0)\n\t\tif (n) this.synthUI.gr.selectNode(n)\n\t}\n\n\tloadPreset(evt: JQuery.Event) {\n\t\tif (!evt) return\n\t\tfile.uploadText(evt, data => {\n\t\t\ttry {\n\t\t\t\tconst json = JSON.parse(data)\n\t\t\t\tif (json.modulatorType != 'synth') throw 'Invalid file format'\n\t\t\t\tthis.presets[this.presetNum] = json\n\t\t\t\tthis.preset2synth()\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e)\n\t\t\t\tpopups.alert('Could not load synth: invalid file format', 'Load error')\n\t\t\t}\n\t\t})\n\t}\n\n\tsavePreset() {\n\t\tconst json = this.synth2preset()\n\t\tconst jsonData = JSON.stringify(json)\n\t\tif (file.browserSupportsDownload()) {\n\t\t\tif (json.name.length == 0) json.name = '' + this.presetNum\n\t\t\tfile.download(json.name + '.json', jsonData)\n\t\t}\n\t\telse {\n\t\t\tpopups.prompt(\n\t\t\t\t'Copy the text below to the clipboard and save it to a local text file',\n\t\t\t\t'Save preset', jsonData, null)\n\t\t}\n\t}\n\n\t// Extension point to specify additional data to save, e.g. keyboard settings\n\tbeforeSave(json: any): void {}\n\t// Extension point to handle previously saved additional data\n\tafterLoad(json: any): void {}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/synthUI/presets.ts","import { Presets } from '../synthUI/presets'\nimport { LiveCoding } from './live-coding';\n\nlet sinkDiv = document.createElement('div')\n\nfunction byId(id: string) {\n\treturn document.getElementById(id) || sinkDiv\n}\n\n// -------------------- Editor setup --------------------\n\nlet monacoRequire = (<any>window).require\ndeclare let monaco: any\nlet editor: any\nlet decorations: any[] = []\nlet currentError: any\n\nfunction loadMonaco(cb: () => void) {\n\tmonacoRequire.config({ paths: { 'vs': 'js/vendor/monaco/min/vs' }})\n\tmonacoRequire(['vs/editor/editor.main'], cb)\n}\n\nexport function createEditor(ac: AudioContext, presets: Presets) {\n\t(<any>window).lc = new LiveCoding(ac, presets)\n\tloadMonaco(function() {\n\t\tregisterHoverHandler()\n\t\tlet editorElem = byId('walc-code-editor')\n\t\teditor = monaco.editor.create(editorElem, {\n\t\t\tvalue: '',\n\t\t\tlanguage: 'typescript',\n\t\t\tlineNumbers: false,\n\t\t\trenderLineHighlight: 'none',\n\t\t\tminimap: { enabled: false }\n\t\t})\n\t\thandleEditorResize(editorElem)\n\t\tregisterActions()\n\t\tpreventParentScroll(editorElem)\n\t})\n}\n\nfunction preventParentScroll(elem: HTMLElement) {\n\t$(elem).bind('mousewheel', e => e.preventDefault())\n}\n\nfunction registerActions() {\n\teditor.addAction({\n\t\tid: 'walc-run',\n\t\tlabel: 'Run code',\n\t\tkeybindings: [ monaco.KeyMod.Alt | monaco.KeyCode.Enter ],\n\t\tcontextMenuGroupId: 'navigation',\n\t\tcontextMenuOrder: 1,\n\t\trun: doRunCode\n\t})\n}\n\nfunction handleEditorResize(elem: HTMLElement) {\n\tlet edh = elem.clientHeight\n\tlet edw = elem.clientWidth\n\tsetInterval(_ => {\n\t\tlet newH = elem.clientHeight\n\t\tlet newW = elem.clientWidth\n\t\tif (edh != newH || edw != newW) {\n\t\t\tedh = newH\n\t\t\tedw = newW\n\t\t\teditor.layout()\n\t\t}\n\t}, 1000)\n}\n\n\n// -------------------- Error handling --------------------\n\nfunction registerHoverHandler() {\n\tmonaco.languages.registerHoverProvider('javascript', {\n\t\tprovideHover: function(model: any, position: any) {\n\t\t\t// TODO: make it dynamic\n\t\t\t// \t\tcall editor.getLineDecorations to get current error position\n\t\t\tif (!currentError ||\n\t\t\t\tposition.lineNumber != currentError.line ||\n\t\t\t\tposition.column > currentError.column) return\n\t\t\treturn {\n\t\t\t\tcontents: [\n\t\t\t\t\t'**Runtime Error**',\n\t\t\t\t\tcurrentError.message\n\t\t\t\t]\n\t\t\t}\n\t\t}\n\t})\n}\n\nfunction getErrorLocation(e: any) {\n\t// Safari\n\tif (e.line)\n\t\treturn { line: e.line, column: e.column }\n\t// Chrome: <anonymous>\n\t// Firefox: > eval\n\tlet match = e.stack.match(/(<anonymous>|> eval):(\\d+):(\\d+)/)\n\tif (match && match.length == 4) {\n\t\treturn {\n\t\t\tline: parseInt(match[2], 10),\n\t\t\tcolumn: parseInt(match[3], 10)\n\t\t}\n\t}\n\treturn null\n}\n\nfunction showError(msg: string, line: number, col: number) {\n\tconsole.log(`Runtime error: \"${msg}\" at line ${line}, column ${col}`)\n\teditor.revealLineInCenter(line)\n\tif (col <= 1)\n\t\tcol = getFirstWordEnd(editor.getModel().getLineContent(line))\n\tdecorations = editor.deltaDecorations(decorations, [{\n\t\trange: new monaco.Range(line, 1, line, col),\n\t\toptions: {\n\t\t\tisWholeLine: false,\n\t\t\tclassName: 'walc-error-line'\n\t\t}\n\t}])\n}\n\nfunction getFirstWordEnd(s: string): number {\n\tlet m = s.match(/\\s*\\w+/)\n\tlet pos = m && m.index !== undefined && m[0] ? m.index + m[0].length + 1 : 0\n\tif (pos <= 1) pos = s.length + 1\n\treturn pos\n}\n\n// -------------------- Code execution --------------------\n\nfunction doRunCode() {\n\tlet code = editor.getModel().getValue()\n\ttry {\n\t\tcurrentError = null\n\t\tdecorations = editor.deltaDecorations(decorations, [])\n\t\t// tslint:disable-next-line:no-eval\n\t\teval(code)\n\t} catch (e) {\n\t\tlet location = getErrorLocation(e)\n\t\tif (location) {\n\t\t\tcurrentError = e\n\t\t\tcurrentError.line = location.line\n\t\t\tcurrentError.column = location.column > 1 ? location.column : 4\n\t\t\tshowError(e.message, location.line, location.column)\n\t\t}\n\t}\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/live-coding/editor.ts","import { Instrument } from '../synth/instrument'\nimport { Presets } from '../synthUI/presets'\nimport { Timer } from '../synth/timer'\n\ntype TrackCallback = (t: Track) => void\n\n\nexport class LiveCoding {\n\tconstructor(public ac: AudioContext, public presets: Presets) {\n\t\tlet timer = new Timer(ac)\n\t\ttimer.start(time => timerCB(timer, time))\n\t}\n\n\tinstrument(preset: string | number, numVoices = 4) {\n\t\tlet prst = getPreset(this.presets, preset)\n\t\treturn new Instrument(this.ac, prst, numVoices)\n\t}\n\n\ttrack(name: string, cb: TrackCallback) {\n\t\tlet t = new Track()\n\t\tt.time = this.ac.currentTime\n\t\ttracks[name] = t\n\t\tcb(t)\n\t}\n}\n\ninterface NoteInfo {\n\tinstrument: Instrument\n\tnumber: number\n\ttime: number\n\tvelocity: number\n\toptions?: any\t// TODO proper options\n}\n\nexport class Track {\n\tnotect = 0\n\tnotes: NoteInfo[] = []\n\tinst: Instrument\n\tvelocity = 1\n\ttime = 0\n\n\tinstrument(inst: Instrument) {\n\t\tthis.inst = inst\n\t\treturn this\n\t}\n\n\tvolume(v: number) {\n\t\tthis.velocity = v\n\t}\n\n\tplay(note = 64, options: any) {\n\t\tif (!this.inst)\n\t\t\tthrow new Error(`Must call instrument before playing a note`)\n\t\tthis.notes.push({\n\t\t\tinstrument: this.inst,\n\t\t\tnumber: note,\n\t\t\ttime: this.time,\n\t\t\tvelocity: this.velocity\n\t\t})\n\t\treturn this\n\t}\n\n\tsleep(time: number) {\n\t\tthis.time += time\n\t\treturn this\n\t}\n}\n\n// -------------------- Privates --------------------\n\ninterface TrackTable {\n\t[trackName: string]: Track\n}\n\nlet tracks: TrackTable = {}\n\nfunction getPreset(presets: Presets, preset: string | number) {\n\tif (typeof preset == 'number') {\n\t\tlet maxPrst = presets.presets.length\n\t\tif (preset < 1 || preset > maxPrst)\n\t\t\tthrow new Error(`The preset number should be between 1 and ${maxPrst}`)\n\t\treturn presets.presets[preset - 1]\n\t}\n\tfor (let prs of presets.presets)\n\t\tif (prs.name == preset) return prs\n\tthrow new Error(`Preset \"${preset}\" does not exist`)\n}\n\nfunction timerCB(timer: Timer, time: number) {\n\tlet tnames = Object.getOwnPropertyNames(tracks)\n\tfor (let tname of tnames) playTrack(timer, tracks[tname], time)\n}\n\nfunction playTrack(timer: Timer, track: Track, time: number) {\n\tlet played\n\tdo {\n\t\tplayed = false\n\t\tif (track.notect >= track.notes.length) break\n\t\tlet note = track.notes[track.notect]\n\t\tif (note.time < timer.nextNoteTime) {\n\t\t\tnote.instrument.noteOn(\n\t\t\t\tnote.number, note.velocity, note.time)\n\t\t\tnote.instrument.noteOff(\n\t\t\t\tnote.number, note.velocity, note.time + timer.noteDuration)\n\t\t\tplayed = true\n\t\t\ttrack.notect++\n\t\t}\n\t} while (played)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/live-coding/live-coding.ts"],"sourceRoot":""}